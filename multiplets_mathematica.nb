(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    195556,       4535]
NotebookOptionsPosition[    190651,       4447]
NotebookOutlinePosition[    191117,       4465]
CellTagsIndexPosition[    191074,       4462]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Functions init (inizialization cells)", "Section",
 CellChangeTimes->{{3.839671180673484*^9, 3.839671187202901*^9}, {
  3.839766998127668*^9, 
  3.8397670462785063`*^9}},ExpressionUUID->"2d257552-89d8-4824-8810-\
853e93dab373"],

Cell[TextData[{
 "in this cell are defined the functions ",
 StyleBox["gkr[mag]",
  FontWeight->"Bold"],
 " (spatial radius) and ",
 StyleBox["gkt[mag]",
  FontWeight->"Bold"],
 " (time interval) for criteria 2 and 3 as continuous interpolations from \
Gardner and Knopoff tables."
}], "Text",
 CellChangeTimes->{{3.839671205856875*^9, 3.839671267039278*^9}, {
  3.839671329722797*^9, 3.839671393953458*^9}, {3.839671431287848*^9, 
  3.839671496853875*^9}},ExpressionUUID->"4318576f-3a1d-429e-866c-\
94e506562991"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Gardner", " ", "and", " ", "Knopoff", " ", "tables"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gardnerknopofflist", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "2.5", ",", "3", ",", "3.5", ",", "4", ",", "4.5", ",", "5", ",", 
          "5.5", ",", "6", ",", "6.5", ",", "7", ",", "7.5", ",", "8"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "19.5", ",", "22.5", ",", "26", ",", "30", ",", "35", ",", "40", ",",
           "47", ",", "54", ",", "61", ",", "70", ",", "81", ",", "94"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "6", ",", "11.5", ",", "22", ",", "42", ",", "83", ",", "155", ",", 
          "290", ",", "510", ",", "790", ",", "915", ",", "960", ",", "985"}],
          "}"}]}], "}"}], "\[Transpose]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"gkr", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"gardnerknopofflist", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"gkt", "=", 
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gardnerknopofflist", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], "/.", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m_", ",", "t_"}], "}"}], "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"t", "/", "365"}]}], "}"}]}]}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7353698625744977`*^9, 3.735369972497489*^9}, {
   3.7353700445806966`*^9, 3.7353700586471033`*^9}, {3.7353703597632113`*^9, 
   3.735370362674503*^9}, {3.7353704101972547`*^9, 3.735370434262661*^9}, {
   3.73538702967519*^9, 3.735387030478389*^9}, 3.735388020262169*^9, {
   3.735444880533826*^9, 3.7354448875215244`*^9}, {3.735534209369173*^9, 
   3.7355342339156275`*^9}, {3.7355358850727267`*^9, 3.735535913058525*^9}, {
   3.736574344298894*^9, 3.7365743899974637`*^9}, {3.736662908466707*^9, 
   3.736662911313992*^9}, {3.737113151210204*^9, 3.737113153068878*^9}, 
   3.7371923278886833`*^9, {3.737696511539801*^9, 3.7376965211038013`*^9}, {
   3.826217187009108*^9, 3.8262172117686787`*^9}, {3.826217282605549*^9, 
   3.8262172909955378`*^9}, {3.826217349447217*^9, 3.8262173560789013`*^9}, {
   3.8396710420951643`*^9, 3.839671044329245*^9}, 3.839671128512809*^9, {
   3.839671291492392*^9, 3.839671303130348*^9}, {3.839671502210697*^9, 
   3.839671532584841*^9}, {3.8396748338336487`*^9, 3.8396748385100946`*^9}, {
   3.839915820619755*^9, 3.839915823556575*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"dd1bbe55-77a3-4a41-877c-3a24b383fa6c"],

Cell[TextData[{
 "This cell defines a fast algorithm to convert {lat, long}  to {x,y} pairs \
obtained projecting spherical coordinates onto the plane parallel to the \
sphere at a certain median point ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["lat", "0"], ",", 
        SubscriptBox["lon", "0"]}], "}"}], " ", "\[LongRightArrow]", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["x", "0"], ",", 
        SubscriptBox["y", "0"]}], "}"}]}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
    RowBox[{"coordinates", " ", "origin"}]}], TraditionalForm]],
  ExpressionUUID->"320b2644-db93-4b02-b084-a8e2c684debf"],
 ". However, any type of similar trasformations (e.g. fast UTM) can be used \
since we actually care only about distances between couples of events."
}], "Text",
 CellChangeTimes->{{3.839671570369713*^9, 3.839671823643355*^9}, {
  3.8396722654687557`*^9, 3.839672404986759*^9}, {3.875596555001213*^9, 
  3.8755966203750677`*^9}},ExpressionUUID->"f0f5c79a-4225-4f7c-b31b-\
e7ea4bc1b21a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", " ", "Function"}], " ", 
      RowBox[{"definition", ":", " ", "\[Phi]"}]}], " ", "\[Rule]", " ", 
     "latitude"}], ",", " ", 
    RowBox[{"\[Lambda]", " ", "\[Rule]", " ", "longitude"}]}], " ", "***)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"caloir2g", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]0_", ",", "\[Lambda]0_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"y", " ", "\[Alpha]"}], "r"], "+", "\[Phi]0", "-", 
        FractionBox[
         RowBox[{"0.5`", " ", 
          SuperscriptBox["x", "2"], " ", "\[Alpha]", " ", 
          RowBox[{"Tan", "[", 
           FractionBox["\[Phi]0", "\[Alpha]"], "]"}]}], 
         SuperscriptBox["r", "2"]]}], ",", 
       RowBox[{"\[Lambda]0", "+", 
        FractionBox[
         RowBox[{"x", " ", "\[Alpha]", " ", 
          RowBox[{"Sec", "[", 
           FractionBox[
            RowBox[{
             FractionBox[
              RowBox[{"y", " ", "\[Alpha]"}], "r"], "+", "\[Phi]0"}], 
            "\[Alpha]"], "]"}]}], "r"], "-", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{
           SuperscriptBox["x", "3"], " ", "\[Alpha]", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{
              FractionBox[
               RowBox[{"y", " ", "\[Alpha]"}], "r"], "+", "\[Phi]0"}], 
             "\[Alpha]"], "]"}], " ", 
           RowBox[{"Tan", "[", 
            FractionBox[
             RowBox[{
              FractionBox[
               RowBox[{"y", " ", "\[Alpha]"}], "r"], "+", "\[Phi]0"}], 
             "\[Alpha]"], "]"}]}]}], 
         RowBox[{"3", " ", 
          SuperscriptBox["r", "3"]}]]}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Rule]", 
        FractionBox["180", "\[Pi]"]}], ",", 
       RowBox[{"r", "\[Rule]", "6367"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"caloig2r", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Phi]_", ",", "\[Lambda]_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]0_", ",", "\[Lambda]0_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"r", " ", 
          RowBox[{"Cos", "[", 
           FractionBox["\[Phi]", "\[Alpha]"], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}]}], "\[Alpha]"], 
        "-", 
        FractionBox[
         RowBox[{" ", 
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", 
            FractionBox["\[Phi]", "\[Alpha]"], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             FractionBox["\[Phi]", "\[Alpha]"], "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}], "3"]}]}], 
         RowBox[{"6", " ", 
          SuperscriptBox["\[Alpha]", "3"]}]]}], ",", 
       RowBox[{
        FractionBox[
         RowBox[{"r", " ", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"2.`", " ", "\[Phi]"}], "\[Alpha]"], "]"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Lambda]", "-", "\[Lambda]0"}], ")"}], "2"]}], 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Alpha]", "2"]}]], "+", 
        FractionBox[
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{"\[Phi]", "-", "\[Phi]0"}], ")"}]}], "\[Alpha]"]}]}], 
      "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Rule]", 
        FractionBox["180", "\[Pi]"]}], ",", 
       RowBox[{"r", "\[Rule]", "6367"}]}], "}"}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820781353337365*^9, 3.8207813888469143`*^9}, {
   3.820781903098702*^9, 3.820781916580435*^9}, {3.82078234997508*^9, 
   3.820782394015123*^9}, 3.820836954849064*^9, {3.8396718344080257`*^9, 
   3.839671854155649*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"0c866893-59fb-4cb2-9bc2-7915aa8b5ecf"],

Cell[TextData[{
 "this cell compiles ",
 StyleBox["caloir2g",
  FontWeight->"Bold"],
 " and ",
 StyleBox["caloig2r",
  FontWeight->"Bold"],
 " functions and links them to the commands ",
 StyleBox["r2g",
  FontWeight->"Bold"],
 " and ",
 StyleBox["g2r",
  FontWeight->"Bold"],
 " respectively (a C compiler must be present in the system)\nIf compilation \
fails the original (much slower) function caloir2g can be used in the orig \
list definition (just remove the ",
 StyleBox["(*",
  FontWeight->"Bold"],
 " and ",
 StyleBox["*)",
  FontWeight->"Bold"],
 " comment delimiters ):\norig=raw/.{t1_?NumberQ,lat_,lon_,dep_,mag1_,_}\
\[RuleDelayed]{t1,Append[",
 StyleBox["(*",
  FontColor->RGBColor[1, 0.5, 0]],
 "caloi",
 StyleBox["*)",
  FontColor->RGBColor[1, 0.5, 0]],
 "g2r[{lat,lon},offs],dep],mag1,i++}\n"
}], "Text",
 CellChangeTimes->{{3.8397670578125553`*^9, 3.839767211334539*^9}, {
  3.839767286295102*^9, 3.839767341655191*^9}, {3.839768175305563*^9, 
  3.839768182853517*^9}, {3.8397684122156277`*^9, 
  3.8397685147133636`*^9}},ExpressionUUID->"53333f2b-a420-4f31-b57a-\
3138c7e85cb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "Function"}], " ", "compilation", " ", "in", " ", "C", 
    " ", 
    RowBox[{"executable", ":", " ", 
     RowBox[{
     "useful", " ", "for", " ", "very", " ", "large", " ", "catalogs"}]}]}], 
   " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r2g", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xy", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]\[Lambda]0", ",", "_Real", ",", "1"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"180", " ", 
              RowBox[{
              "xy", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             
             RowBox[{"6367", " ", "\[Pi]"}]], "+", 
            RowBox[{
            "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "-", 
            RowBox[{"7.066802223560106`*^-7", " ", 
             SuperscriptBox[
              RowBox[{
              "xy", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "2"], " ", 
             RowBox[{"Tan", "[", 
              FractionBox[
               RowBox[{"\[Pi]", " ", 
                RowBox[{
                "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "180"], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
            "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "+", 
            FractionBox[
             RowBox[{"180", " ", 
              RowBox[{
              "xy", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              " ", 
              RowBox[{"Sec", "[", 
               RowBox[{
                FractionBox["1", "180"], " ", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"180", " ", 
                    RowBox[{
                    "xy", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], 
                   RowBox[{"6367", " ", "\[Pi]"}]], "+", 
                  RowBox[{
                  "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], "]"}]}], 
             RowBox[{"6367", " ", "\[Pi]"}]], "-", 
            FractionBox[
             RowBox[{"60", " ", 
              SuperscriptBox[
               RowBox[{
               "xy", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "3"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                FractionBox["1", "180"], " ", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"180", " ", 
                    RowBox[{
                    "xy", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], 
                   RowBox[{"6367", " ", "\[Pi]"}]], "+", 
                  RowBox[{
                  "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], "]"}], " ", 
              RowBox[{"Tan", "[", 
               RowBox[{
                FractionBox["1", "180"], " ", "\[Pi]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"180", " ", 
                    RowBox[{
                    "xy", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], 
                   RowBox[{"6367", " ", "\[Pi]"}]], "+", 
                  RowBox[{
                  "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], "]"}]}], 
             RowBox[{"258109832863", " ", "\[Pi]"}]]}]}], "}"}]}], ",", 
        RowBox[{
         TemplateBox[{
           Cell[
            TextData["RuntimeOptions"]], "paclet:ref/RuntimeOptions"},
          "RefLink",
          BaseStyle->{"InlineFormula"}], "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2r", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Phi]\[Lambda]", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]\[Lambda]0", ",", "_Real", ",", "1"}], "}"}]}], 
         "}"}], ",", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["6367", "180"], " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"\[Pi]", " ", 
                RowBox[{
                "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "180"], "]"}]}], "-", 
            FractionBox[
             RowBox[{"6367", " ", 
              SuperscriptBox["\[Pi]", "3"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}], "3"], " ", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"\[Pi]", " ", 
                 RowBox[{
                 "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "180"], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", 
                FractionBox[
                 RowBox[{"\[Pi]", " ", 
                  RowBox[{
                  "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "180"], "]"}], "2"]}], 
             "34992000"]}], ",", 
           RowBox[{
            RowBox[{
             FractionBox["6367", "180"], " ", "\[Pi]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ")"}]}], "+", 
            FractionBox[
             RowBox[{"6367", " ", 
              SuperscriptBox["\[Pi]", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                 "\[Phi]\[Lambda]0", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}], "2"], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"0.03490658503988659`", " ", 
                RowBox[{
                "\[Phi]\[Lambda]", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "129600"]}]}], "}"}]}],
         ",", 
        RowBox[{
         TemplateBox[{
           Cell[
            TextData["RuntimeOptions"]], "paclet:ref/RuntimeOptions"},
          "RefLink",
          BaseStyle->{"InlineFormula"}], "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820811731674284*^9, 3.820811960095992*^9}, {
   3.8208120055870647`*^9, 3.820812058060439*^9}, {3.820812096672111*^9, 
   3.820812110200639*^9}, {3.820812169059099*^9, 3.82081218168114*^9}, {
   3.8208122612561293`*^9, 3.82081233396093*^9}, {3.820812399840623*^9, 
   3.820812434787882*^9}, 3.8208443263967752`*^9, {3.8208443585713987`*^9, 
   3.820844361898673*^9}, 3.839671829815331*^9, {3.839671863891362*^9, 
   3.8396718980615883`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"97bec193-9865-46ce-95ac-7ab3a3e8c628"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Disk3D", "[", 
   RowBox[{"p_", ",", "r_", ",", 
    RowBox[{"t_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"Cylinder", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"p", ",", "t"}], "]"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"p", ",", 
        RowBox[{"t", "+", "0.0001"}]}], "]"}]}], "}"}], ",", "r"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gkDisk", "[", 
   RowBox[{"p_", ",", "t_", ",", "mag_", ",", 
    RowBox[{"id_", ":", "0"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cylinder", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"p", ",", "t"}], "]"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{"p", ",", 
          RowBox[{"t", "+", 
           RowBox[{"gkt", "[", "mag", "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"gkr", "[", "mag", "]"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"id", "\[NotEqual]", "0"}], ",", 
      RowBox[{"Text", "[", 
       RowBox[{"id", ",", 
        RowBox[{"Append", "[", 
         RowBox[{"p", ",", 
          RowBox[{"t", "+", 
           RowBox[{".05", "*", 
            RowBox[{"gkt", "[", "mag", "]"}]}]}]}], "]"}]}], "]"}], ",", 
      "Nothing"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"il", "[", "y_", "]"}], ":=", 
   RowBox[{"InfiniteLine", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "y"}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7354449948742585`*^9, 3.735445032440015*^9}, {
   3.7354498511574235`*^9, 3.7354498976654234`*^9}, {3.735453169808736*^9, 
   3.735453185521307*^9}, {3.735464511844826*^9, 3.7354645178774295`*^9}, {
   3.7354651040150375`*^9, 3.7354651615197873`*^9}, {3.73546528805544*^9, 
   3.7354653110787416`*^9}, {3.735465692238657*^9, 3.735465709041204*^9}, {
   3.735465742308569*^9, 3.735465806397257*^9}, {3.735466057408947*^9, 
   3.7354660656004887`*^9}, {3.735467293053999*^9, 3.735467298542548*^9}, 
   3.735470046055272*^9, 3.7354709452751846`*^9, 3.7354712934660006`*^9, {
   3.7354718398886375`*^9, 3.7354718639530435`*^9}, {3.735471942773925*^9, 
   3.7354719895266*^9}, {3.73547275280892*^9, 3.735472796300269*^9}, {
   3.735472908094447*^9, 3.735472933183956*^9}, {3.73556366292537*^9, 
   3.735563686430721*^9}, {3.7355637186079383`*^9, 3.7355637210241795`*^9}, {
   3.7355637740664835`*^9, 3.7355638606141376`*^9}, {3.8203179935362787`*^9, 
   3.820318060186697*^9}, {3.8205821900428553`*^9, 3.8205822058202*^9}, {
   3.8206082475201178`*^9, 3.820608248877211*^9}, {3.820609574075046*^9, 
   3.820609583892111*^9}, {3.8206097097746897`*^9, 3.820609710175975*^9}, {
   3.820610412401801*^9, 3.820610414732998*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"3dc942fb-fd55-4cbc-9f89-9bc8514c3e69"],

Cell["\<\
this cell defines a function to generate a sequence of n elements from min to \
max whose interdistance is variable. When shrink is 0 points are equidistant, \
while positive value concentrate points at the min value (interdistance \
increasing) and negative do the opposite. Useful for the calculation of some \
histogarams with different size bins ()\
\>", "Text",
 CellChangeTimes->{{3.8403514295854816`*^9, 3.8403514488251143`*^9}, {
  3.840352175394376*^9, 3.840352416295095*^9}, {3.840361256412306*^9, 
  3.840361437185755*^9}},ExpressionUUID->"0efbab32-beb2-40de-9109-\
7ef99f959725"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "expseq", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expseq", "[", 
   RowBox[{"min_", ",", "max_", ",", "n_", ",", "shrink_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"min", ",", "max", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"max", "-", "min"}], ")"}], "/", "n"}]}], "]"}], ",", 
         RowBox[{"shrink", "==", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"Exp", "[", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "shrink", ",", 
              RowBox[{"shrink", "/", "n"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"N", "@", 
           RowBox[{"Rescale", "[", 
            RowBox[{"r", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Exp", "[", "shrink", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"shrink", "!=", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.840174249990333*^9, 3.840174395427822*^9}, {
   3.8401745787563457`*^9, 3.840174606354577*^9}, 3.840174666955875*^9, {
   3.840175256600779*^9, 3.840175265247645*^9}, {3.8403515244942503`*^9, 
   3.840351564553774*^9}, {3.840351664750801*^9, 3.840351764478586*^9}, {
   3.840351802313631*^9, 3.840351835724818*^9}, {3.8403525075128603`*^9, 
   3.840352556596518*^9}, {3.8403525907680264`*^9, 3.840352635481289*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2d1dbb5d-0816-40f9-840f-9c99ab629ba3"],

Cell[CellGroupData[{

Cell["con scelta grafici", "Subsection",
 CellChangeTimes->{{3.840352473631403*^9, 3.8403524757191343`*^9}, 
   3.8414002452915497`*^9, {3.84295042537237*^9, 3.842950467413351*^9}, {
   3.8429512539964657`*^9, 3.842951271583068*^9}, {3.842951393628636*^9, 
   3.842951400311878*^9}, {3.8429516217772923`*^9, 3.8429517382677593`*^9}, {
   3.8463115119075603`*^9, 
   3.846311573479474*^9}},ExpressionUUID->"0aea74f1-3b4d-4806-9847-\
c43ccfcc2d13"],

Cell["this cell extracts some useful information from catalog ", "Text",
 CellChangeTimes->{{3.8397714351785803`*^9, 3.839771464222197*^9}, {
   3.840530209875791*^9, 3.8405302115629997`*^9}, 
   3.841400265231694*^9},ExpressionUUID->"2ffbe1a3-c67c-4e10-aacf-\
abcd7ca8914f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"infodata", "[", 
   RowBox[{"indata_", ",", 
    RowBox[{"OptionsPattern", "[", 
     RowBox[{"info", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<mag\>\"", ",", "\"\<times\>\""}], "}"}]}], "]"}]}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "f", ",", "mags", ",", "itb", ",", "itf", ",", "tdiffs", ",", 
      "loghistbins", ",", "u", ",", "expfit", ",", "qplott", ",", "qplotm"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mags", "=", 
      RowBox[{"indata", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "file", "]"}], "===", "String"}], ",", "file", 
        ",", "dfile"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "info", "]"}], ",", "\"\<times\>\""}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"interevents", " ", "times", " ", "range"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tdiffs", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"indata", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
            "Differences"}], ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "<=", "0"}], "&"}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"itb", ",", "itf"}], "}"}], "=", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{"MinMax", "[", "tdiffs", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"min_", ",", "max_"}], "}"}], ":>", 
           RowBox[{"10", "^", 
            RowBox[{"Round", "[", 
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extracts", " ", "variable", " ", "width", " ", "bins", " ", 
          "content", " ", "from", " ", "interevent", " ", "times", " ", 
          RowBox[{"distribution", ":", " ", 
           RowBox[{"Log", " ", "are"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"loghistbins", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Mean", "/@", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{"xpts", "=", 
                  RowBox[{"expseq", "[", 
                   RowBox[{"itb", ",", "itf", ",", "100", ",", "12"}], 
                   "]"}]}], ",", "2", ",", "1"}], "]"}]}], ",", 
              RowBox[{"Log10", "/@", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"BinCounts", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"indata", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//",
                     "Differences"}], ",", 
                   RowBox[{"{", "xpts", "}"}]}], "]"}], 
                 RowBox[{
                  RowBox[{"Differences", "@", "xpts"}], " ", "*", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "[", "indata", "]"}], "-", "1"}], 
                   ")"}]}]], ")"}]}]}], "}"}], "\[Transpose]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"_", "?", "NumberQ"}], ",", 
             RowBox[{"_", "?", "NumberQ"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"expfit", "=", 
         RowBox[{"FindDistributionParameters", "[", 
          RowBox[{"tdiffs", ",", 
           RowBox[{"ExponentialDistribution", "[", "u", "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"grd", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Sort", "@", 
         RowBox[{"Tally", "[", "mags", "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m_", ",", "n_"}], "}"}], "\[RuleDelayed]", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"Reverse", "@", 
            RowBox[{"Accumulate", "@", 
             RowBox[{"Reverse", "@", "n"}]}]}]}], "}"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Fit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"grd", ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "0"}], "}"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m_", ",", "n_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Log", "[", "n", "]"}]}], "}"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plots", "=", 
      RowBox[{"PadRight", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "info", "]"}], ",", "\"\<mag\>\""}],
              "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"ListLogPlot", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Legended", "[", 
                 RowBox[{
                  RowBox[{"Tally", "[", "mags", "]"}], ",", 
                  RowBox[{"Placed", "[", 
                   RowBox[{"\"\<Events number\>\"", ",", "Above"}], "]"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Legended", "[", 
                 RowBox[{"grd", ",", 
                  RowBox[{"Placed", "[", 
                   RowBox[{"\"\<Cumulative number\>\"", ",", "Above"}], 
                   "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
              RowBox[{"Filling", "\[Rule]", "0"}], ",", 
              RowBox[{"Joined", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"False", ",", "True"}], "}"}]}], ",", " ", 
              RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "320"}], ",", " ", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<b-value: ``\>\"", ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"res", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "/", 
                  RowBox[{"Log", "[", "10", "]"}]}]}], "]"}]}], ",", " ", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Dotted", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"(", 
                    RowBox[{"res", "/.", 
                    RowBox[{"x", "\[Rule]", "#"}]}], ")"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"MinMax", "[", "mags", "]"}]}], "]"}]}], "}"}]}]}],
              "]"}], "\[IndentingNewLine]", ",", "Nothing"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"plott", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "info", "]"}], ",", 
               "\"\<times\>\""}], "]"}], ",", 
             RowBox[{"ListLogLinearPlot", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"loghistbins", "/.", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"y", "-", 
                    RowBox[{"Log10", "@", 
                    RowBox[{"PDF", "[", 
                    RowBox[{
                    RowBox[{"ExponentialDistribution", "[", 
                    RowBox[{"u", "/.", "expfit"}], "]"}], ",", "x"}], 
                    "]"}]}]}]}], "}"}]}]}], ",", " ", 
               RowBox[{"Joined", "\[Rule]", "False"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "320"}], "\[IndentingNewLine]",
                ",", 
               RowBox[{
               "PlotLabel", "->", 
                "\"\<\!\(\*SubscriptBox[\(log\), \(10\)]\) distance \
of\\ninterevent times bin counts\\n from exponential distr\>\""}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"itb", ",", "itf"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Frame", "->", "True"}], ",", 
               RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
             "\[IndentingNewLine]", ",", "Nothing"}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", "2", ",", "SpanFromLeft"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"general", " ", "file", " ", "info"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<`` (``)\>\"", ",", 
             RowBox[{"FileBaseName", "[", "f", "]"}], ",", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Or", "[", 
                RowBox[{
                 RowBox[{"catalogo", "\[Equal]", "0"}], ",", 
                 RowBox[{
                  RowBox[{"Head", "[", "catalogo", "]"}], "==", "Symbol"}]}], 
                "]"}], ",", 
               RowBox[{"DateString", "[", 
                RowBox[{"FileDate", "[", "dfile", "]"}], "]"}], 
               RowBox[{"(*", " ", 
                RowBox[{
                "dfile", " ", "is", " ", "the", " ", "actual", " ", "opened", 
                 " ", "file", " ", 
                 RowBox[{"(", 
                  RowBox[{"zip", " ", "or", " ", "not"}], ")"}], " ", "and", 
                 " ", "has", " ", "a", " ", "date", " ", "attached"}], " ", 
                "*)"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"catalogo", ">", "0"}], ",", 
               RowBox[{"\"\<Randomized \[Rule] \>\"", "<>", 
                RowBox[{
                "nts", "\[LeftDoubleBracket]", "catalogo", 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], ",", 
           "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<containing `` events spanning on `` years\\nMagnitudo range: \
`` (discretization granularity:  ``)\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"Length", "[", "indata", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Ceiling", "@", 
               RowBox[{"Max", "@", 
                RowBox[{"indata", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
              "-", 
              RowBox[{"Floor", "@", 
               RowBox[{"Min", "@", 
                RowBox[{"indata", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"MinMax", "[", "mags", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", "mags", "]"}], "//", "Differences"}], "//", 
               RowBox[{
                RowBox[{"Round", "[", 
                 RowBox[{"#", ",", ".000001"}], "]"}], "&"}]}], "//", 
              "Min"}]}], "\[IndentingNewLine]", "]"}], ",", "SpanFromLeft"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"plots", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"SpanFromLeft", ",", "SpanFromLeft"}], "}"}], "->", 
           "Nothing"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "All"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8463089981722307`*^9, 3.846309011009199*^9}, {
   3.846309041814237*^9, 3.846309199076396*^9}, {3.8463092395984993`*^9, 
   3.846309280682695*^9}, {3.8463093120259867`*^9, 3.8463093329295473`*^9}, {
   3.846309375949031*^9, 3.8463094746876574`*^9}, {3.846309679309947*^9, 
   3.8463097174163218`*^9}, {3.846309748763363*^9, 3.846309830562068*^9}, {
   3.8463098667935743`*^9, 3.8463099981039352`*^9}, {3.846310029940928*^9, 
   3.84631003995763*^9}, {3.8463101221429234`*^9, 3.846310169190811*^9}, {
   3.846310200617731*^9, 3.8463103702365913`*^9}, {3.846310414912732*^9, 
   3.8463104557834873`*^9}, {3.8463104925553713`*^9, 
   3.8463105281693573`*^9}, {3.846310596020825*^9, 3.846310599204795*^9}, {
   3.8463106537329073`*^9, 3.846310654857135*^9}, 3.846310777161785*^9, {
   3.846310817811569*^9, 3.846310818489143*^9}, {3.846311239065381*^9, 
   3.8463114641496162`*^9}, 3.875597785584447*^9, {3.8755979524717817`*^9, 
   3.875598067713263*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"f6aa0e7b-7a1f-440d-a2a0-648ee2ebed31"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temp cell", "Section",
 CellChangeTimes->{{3.8396736868118057`*^9, 3.83967369297272*^9}, {
  3.8414002956148767`*^9, 
  3.841400299245962*^9}},ExpressionUUID->"b85a94c2-4ed1-4ae5-b912-\
1d425e894d28"],

Cell[CellGroupData[{

Cell["test file loading ", "Subsection",
 CellChangeTimes->{{3.840707754750865*^9, 3.840707770470132*^9}, {
  3.875771205721036*^9, 
  3.875771213469562*^9}},ExpressionUUID->"394754c4-d1b9-4b86-b464-\
8552fc129f62"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "file", "=", 
   "\"\</Users/robertocarluccio/ownCloud/work/rodolfo/poster2021/selezione \
cpti/CPTI15_5km_1650_M50_symfmt.txt\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.839672039525285*^9, 3.839672068749795*^9}, 
   3.839672530233789*^9, {3.8396745167198753`*^9, 3.839674535210505*^9}, 
   3.839674600738481*^9, {3.839674643557843*^9, 3.8396746500056267`*^9}, 
   3.839676351419527*^9, 3.8396945514640083`*^9, {3.839694677336936*^9, 
   3.839694697373349*^9}, 3.840172182279139*^9, 3.840529124155221*^9, 
   3.8405301335945177`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"8352a4da-6c00-4d12-b145-28b93997cc22"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "file", "=", 
   "\"\</Volumes/GoogleDrive/Il mio Drive/Colab \
Notebooks/multiplette/dati/itcs_app_sett_M40_03_10_10_geo.txt\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.839672039525285*^9, 3.839672068749795*^9}, 
   3.839672530233789*^9, {3.8396745167198753`*^9, 3.839674535210505*^9}, 
   3.839674600738481*^9, {3.839674643557843*^9, 3.8396746500056267`*^9}, 
   3.839676351419527*^9, 3.8396945514640083`*^9, {3.839694677336936*^9, 
   3.839694697373349*^9}, 3.840172182279139*^9, 3.840529124155221*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"3cd6966a-18e9-4238-8d28-3277bc6ebe54"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FileBaseName", "[", "file", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"raw", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"file", ",", "\"\<table\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Short", "[", "raw", "]"}], "\n", 
 RowBox[{
  RowBox[{"Length", "[", "raw", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"offs", "=", 
    RowBox[{"Mean", "[", 
     RowBox[{"raw", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"raw", " ", "\[LongRightArrow]", " ", "orig"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orig", "=", 
   RowBox[{"raw", "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t1_", "?", "NumberQ"}], ",", "lat_", ",", "lon_", ",", "dep_",
        ",", "mag1_", ",", "_"}], "}"}], "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"t1", ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"g2r", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lat", ",", "lon"}], "}"}], ",", "offs"}], "]"}], ",", 
         "dep"}], "]"}], ",", "mag1", ",", 
       RowBox[{"i", "++"}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Short", "[", "orig", "]"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.839672039525285*^9, 3.839672068749795*^9}, 
   3.839672530233789*^9, {3.8396745167198753`*^9, 3.839674535210505*^9}, 
   3.839674600738481*^9, {3.839674643557843*^9, 3.8396746500056267`*^9}, 
   3.839676351419527*^9, 3.8396945514640083`*^9, {3.839694677336936*^9, 
   3.839694697373349*^9}, 3.840172182279139*^9, 3.840529124155221*^9, {
   3.840530159525964*^9, 3.840530178331346*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"802ffbfd-7999-4f14-903d-cb185cee7a46"],

Cell[BoxData["\<\"itcs_app_sett_M40_03_10_10_geo\"\>"], "Output",
 CellChangeTimes->{
  3.84017219372433*^9, 3.840342782311371*^9, 3.8405157032931547`*^9, 
   3.840530141734515*^9, 3.84053017977487*^9, {3.840535530275943*^9, 
   3.840535550952256*^9}, 3.8405360006449213`*^9, 3.840704076040798*^9, 
   3.840860583761064*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"121c9a80-9d76-400c-aafa-200df61759bb"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.20097`", ",", "43.7374`", ",", "12.4824`", ",", "4.81`", ",", "4.24`",
       ",", "170"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "0.20799`", ",", "43.9473`", ",", "12.5146`", ",", "9.75`", ",", "4.24`",
       ",", "63"}], "}"}], ",", 
    RowBox[{"\[LeftSkeleton]", "225926", "\[RightSkeleton]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "100000.1649`", ",", "44.5036`", ",", "12.2703`", ",", "2.25`", ",", 
      "4.51`", ",", "27"}], "}"}]}], "}"}],
  Short]], "Output",
 CellChangeTimes->{
  3.84017219372433*^9, 3.840342782311371*^9, 3.8405157032931547`*^9, 
   3.840530141734515*^9, 3.84053017977487*^9, {3.840535530275943*^9, 
   3.840535550952256*^9}, 3.8405360006449213`*^9, 3.840704076040798*^9, 
   3.840860587692071*^9},
 CellLabel->
  "Out[17]//Short=",ExpressionUUID->"da11e46c-991c-4c61-be19-49091f4a9d1f"],

Cell[BoxData["225929"], "Output",
 CellChangeTimes->{
  3.84017219372433*^9, 3.840342782311371*^9, 3.8405157032931547`*^9, 
   3.840530141734515*^9, 3.84053017977487*^9, {3.840535530275943*^9, 
   3.840535550952256*^9}, 3.8405360006449213`*^9, 3.840704076040798*^9, 
   3.8408605876935368`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"80dd75f4-0701-4de2-b3a7-b6e12c236e70"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.20097`", ",", 
      RowBox[{"{", 
       RowBox[{
       "18.48086077667136`", ",", "6.130885935110931`", ",", "4.81`"}], "}"}],
       ",", "4.24`", ",", "1"}], "}"}], ",", 
    RowBox[{"\[LeftSkeleton]", "225927", "\[RightSkeleton]"}], ",", 
    RowBox[{"{", 
     RowBox[{"100000.1649`", ",", 
      RowBox[{"{", 
       RowBox[{
       "1.4327427657805865`", ",", "91.24944175502274`", ",", "2.25`"}], 
       "}"}], ",", "4.51`", ",", "225929"}], "}"}]}], "}"}],
  Short]], "Output",
 CellChangeTimes->{
  3.84017219372433*^9, 3.840342782311371*^9, 3.8405157032931547`*^9, 
   3.840530141734515*^9, 3.84053017977487*^9, {3.840535530275943*^9, 
   3.840535550952256*^9}, 3.8405360006449213`*^9, 3.840704076040798*^9, 
   3.8408605902183113`*^9},
 CellLabel->
  "Out[22]//Short=",ExpressionUUID->"72765a55-70dd-4d4c-b698-4bd6419f3350"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Program", "Section",
 CellChangeTimes->{{3.8405291511744347`*^9, 
  3.840529160541095*^9}},ExpressionUUID->"2fd14590-5081-42e9-96a3-\
df3f81ede526"],

Cell["\<\
The program is divided (for convenience) in  3 separated cells :
1) File loader for catalog import, preparation 
2) catalog  info extraction
3) Interactive panel, from which parameters are entered, search started and \
results analysed\
\>", "Text",
 CellChangeTimes->{{3.8397686133249903`*^9, 3.839768760298196*^9}, {
  3.8397688584238853`*^9, 3.839768937485334*^9}, {3.839771208893053*^9, 
  3.839771275460402*^9}, {3.8405297833118877`*^9, 
  3.84052978497893*^9}},ExpressionUUID->"8dbc9d81-b514-4f0f-af15-\
4497eafb8b98"],

Cell[CellGroupData[{

Cell["1) File Loader", "Subsection",
 CellChangeTimes->{{3.839694799122304*^9, 3.8396948117567387`*^9}, {
  3.839782336197644*^9, 
  3.839782338006997*^9}},ExpressionUUID->"dd2921a5-d352-40bf-951e-\
6501c73d7cf6"],

Cell[TextData[{
 "This cell imports the catalog, a plain ascii text table whose rows are \
expected to be:\n ",
 Cell[BoxData[GridBox[{
    {
     RowBox[{"time", 
      RowBox[{"(", "y", ")"}]}], 
     RowBox[{"geo", " ", "lat"}], 
     RowBox[{"geo", " ", "lon"}], 
     RowBox[{"depth", 
      RowBox[{"(", "km", ")"}]}], "mag", 
     RowBox[{"cell", "#"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"ab95ab8d-1a56-4204-8343-1451fca42367"],
 "\nIf the general format is correct, data events contained in list ",
 StyleBox["raw",
  FontWeight->"Bold"],
 " are transformed in the  list ",
 StyleBox["orig.",
  FontWeight->"Bold"],
 "\nIn list ",
 StyleBox["raw",
  FontWeight->"Bold"],
 " the events are expressed in geographic (lat,lon) spherical coordinates\n\
while in list ",
 StyleBox["orig",
  FontWeight->"Bold"],
 " they are referred in a generic cartesian  {x,y,z} framework relative to a \
local central point\n",
 Cell[BoxData[GridBox[{
    {
     RowBox[{"time", 
      RowBox[{"(", "y", ")"}]}], 
     RowBox[{"relative", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "mag", 
     RowBox[{"line", "#"}]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"2f3f1f38-7ab4-4eec-b690-964cfbbee89d"]
}], "Text",
 CellChangeTimes->{{3.839771279098834*^9, 3.839771413677101*^9}, {
  3.840529203323474*^9, 3.8405294150125847`*^9}, {3.8405295091305017`*^9, 
  3.8405297762041388`*^9}, {3.875535182872239*^9, 
  3.8755351855282297`*^9}},ExpressionUUID->"20a687b4-8cb9-41d0-860d-\
df0bb446769d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"catalog", " ", "import"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dfile", "=", 
     RowBox[{"SystemDialogInput", "[", "\"\<FileOpen\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FileExtension", "[", "dfile", "]"}], "==", "\"\<zip\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"archive", "=", 
        RowBox[{"Import", "[", "dfile", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"file", "=", 
        RowBox[{"DialogInput", "[", 
         RowBox[{"{", 
          RowBox[{"(*", " ", 
           RowBox[{
           "select", " ", "file", " ", "in", " ", "zip", " ", "archive"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "TextCell", "[", "\"\<Choose a file from archive: \>\"", "]"}], 
           ",", 
           RowBox[{"SetterBar", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "fr", "]"}], ",", "archive", ",", 
             RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "]"}], ",", 
           RowBox[{"DefaultButton", "[", 
            RowBox[{"DialogReturn", "[", "fr", "]"}], "]"}]}], "}"}], "]"}]}],
        ";", 
       RowBox[{"raw", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"dfile", ",", 
          RowBox[{"{", 
           RowBox[{"file", ",", "\"\<table\>\""}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", " ", 
      RowBox[{"raw", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"dfile", ",", "\"\<table\>\""}], "]"}]}]}], "]"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"ascii", " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Tally", "[", 
          RowBox[{"Length", "/@", "raw"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"6", ",", "_Integer"}], "}"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<malformed catalog file !!!\>\"", "]"}], ";", 
       RowBox[{"Interrupt", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"raw", " ", "\[LongRightArrow]", " ", "orig"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"offs", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"raw", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"orig", "=", 
        RowBox[{"raw", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t1_", "?", "NumberQ"}], ",", "lat_", ",", "lon_", ",", 
            "dep_", ",", "mag1_", ",", "_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"t1", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"(*", "caloi", "*)"}], 
             RowBox[{
              RowBox[{"g2r", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"lat", ",", "lon"}], "}"}], ",", "offs"}], "]"}], 
              ",", "dep"}], "]"}], ",", "mag1", ",", 
            RowBox[{"i", "++"}]}], "}"}]}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Short", "[", "orig", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.83969466977108*^9, 3.839694670290978*^9}, {
   3.839694726478065*^9, 3.83969475469457*^9}, {3.839694950323979*^9, 
   3.839695000031797*^9}, 3.8396968360687647`*^9, {3.839697042149746*^9, 
   3.839697060661435*^9}, {3.83969751649699*^9, 3.8396975476624527`*^9}, {
   3.8396975968685293`*^9, 3.839697620068404*^9}, {3.839697677172276*^9, 
   3.839697735863867*^9}, 3.8396979567794724`*^9, {3.839698180567061*^9, 
   3.839698186558441*^9}, {3.83976100605927*^9, 3.839761068868993*^9}, {
   3.839761245416794*^9, 3.8397612565185757`*^9}, {3.839766243403491*^9, 
   3.839766252949724*^9}, {3.839768215576836*^9, 3.839768216596037*^9}, {
   3.839768387643055*^9, 3.839768393859398*^9}, {3.839768789399537*^9, 
   3.839768825816584*^9}, {3.839768960323925*^9, 3.839768967676515*^9}, {
   3.839769014564748*^9, 3.839769025937204*^9}, {3.839769097181294*^9, 
   3.839769141975724*^9}, {3.839769253000575*^9, 3.839769281235423*^9}, {
   3.839769656983532*^9, 3.839769657634809*^9}, {3.8397697299899406`*^9, 
   3.839769779577787*^9}, {3.839770041448097*^9, 3.839770043955515*^9}, 
   3.8397708963116903`*^9, {3.839913753562642*^9, 3.8399137647851343`*^9}, 
   3.8399139852288303`*^9, 3.841383250175766*^9, {3.84140044081462*^9, 
   3.841400472165904*^9}, 3.84140051040598*^9, {3.846311673727528*^9, 
   3.8463116891431637`*^9}, {3.862403473163612*^9, 3.8624035037713013`*^9}, {
   3.862403542243149*^9, 3.862403548762856*^9}, {3.8757716203316097`*^9, 
   3.875771629985591*^9}, 
   3.875771720164753*^9},ExpressionUUID->"7df17c96-2d92-4c4a-a388-\
14eda996d67a"],

Cell[BoxData[
 TagBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.18344`", ",", 
      RowBox[{"{", 
       RowBox[{"160.3042473664279`", ",", 
        RowBox[{"-", "83.68068472750207`"}], ",", "19.49`"}], "}"}], ",", 
      "4.14`", ",", "1"}], "}"}], ",", 
    RowBox[{"\[LeftSkeleton]", "337252", "\[RightSkeleton]"}], ",", 
    RowBox[{"{", 
     RowBox[{"99999.89479`", ",", 
      RowBox[{"{", 
       RowBox[{
       "66.66757444521426`", ",", "23.345312130812474`", ",", "6.08`"}], 
       "}"}], ",", "3.99`", ",", "337254"}], "}"}]}], "}"}],
  Short]], "Output",
 CellChangeTimes->{3.875596775003784*^9, 3.875608113344404*^9, 
  3.875613665327631*^9, 3.875614057636407*^9, 3.87561413285851*^9, 
  3.875614581029641*^9, 3.875614620569248*^9, 3.875614657727763*^9, 
  3.875771273994732*^9},
 CellLabel->
  "Out[17]//Short=",ExpressionUUID->"55a2ce53-6cdf-4f79-a4d9-0d777e23a365"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2) catalog info extraction", "Subsection",
 CellChangeTimes->{{3.83969466977108*^9, 3.839694670290978*^9}, {
   3.839694726478065*^9, 3.83969475469457*^9}, {3.839694950323979*^9, 
   3.839695000031797*^9}, 3.8396968360687647`*^9, {3.839697042149746*^9, 
   3.839697060661435*^9}, {3.83969751649699*^9, 3.8396975476624527`*^9}, {
   3.8396975968685293`*^9, 3.839697620068404*^9}, {3.839697677172276*^9, 
   3.839697735863867*^9}, 3.8396979567794724`*^9, {3.839698180567061*^9, 
   3.839698186558441*^9}, {3.83976100605927*^9, 3.839761068868993*^9}, {
   3.839761245416794*^9, 3.8397612565185757`*^9}, {3.839766243403491*^9, 
   3.839766252949724*^9}, {3.839768215576836*^9, 3.839768216596037*^9}, {
   3.839768387643055*^9, 3.839768393859398*^9}, {3.839768789399537*^9, 
   3.839768825816584*^9}, {3.839768960323925*^9, 3.839768967676515*^9}, {
   3.839769014564748*^9, 3.839769025937204*^9}, {3.839769097181294*^9, 
   3.839769141975724*^9}, {3.839769253000575*^9, 3.839769281235423*^9}, {
   3.839769656983532*^9, 3.839769657634809*^9}, {3.8397697299899406`*^9, 
   3.839769779577787*^9}, {3.839770041448097*^9, 3.839770043955515*^9}, 
   3.8397708963116903`*^9, {3.8397711885163507`*^9, 3.839771197706449*^9}, {
   3.839782342090171*^9, 
   3.8397823437988367`*^9}},ExpressionUUID->"3f2329e2-c500-4bdf-aa0e-\
388697c101b6"],

Cell[CellGroupData[{

Cell["old cell", "Subsubsection",
 CellChangeTimes->{{3.8414003171431923`*^9, 
  3.841400323621187*^9}},ExpressionUUID->"abac43e3-54b9-4bbb-b921-\
182846ebf0ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mags", "=", 
    RowBox[{"orig", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"extracts", " ", "bins", " ", 
    RowBox[{"(", 
     RowBox[{"of", " ", "different", " ", "length"}], ")"}], " ", "content", 
    " ", "from", " ", "interevent", " ", "times", " ", "distributions"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"loghistbins", "=", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"xpts", "=", 
             RowBox[{"expseq", "[", 
              RowBox[{"0", ",", "2", ",", "60", ",", "8"}], "]"}]}], ",", "2",
             ",", "1"}], "]"}]}], ",", 
         RowBox[{"Log10", "/@", 
          RowBox[{"(", 
           FractionBox[
            RowBox[{"BinCounts", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"orig", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
               "Differences"}], ",", 
              RowBox[{"{", "xpts", "}"}]}], "]"}], 
            RowBox[{
             RowBox[{"Differences", "@", "xpts"}], " ", "*", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", "orig", "]"}], "-", "1"}], ")"}]}]], 
           ")"}]}]}], "}"}], "\[Transpose]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "NumberQ"}], ",", 
        RowBox[{"_", "?", "NumberQ"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "parameter", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"expfit", "=", 
    RowBox[{"FindDistributionParameters", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"orig", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
       "Differences"}], ",", 
      RowBox[{"ExponentialDistribution", "[", "u", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"info", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringForm", "[", 
         RowBox[{
         "\"\<Catalog file `` (``)\\ncontaining `` events spanning on `` \
years\\nMagnitudo range: `` (discretization granularity:  ``)\>\"", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FileBaseName", "[", "file", " ", "]"}], ",", 
          RowBox[{"Quiet", "@", 
           RowBox[{"DateString", "[", 
            RowBox[{"Check", "[", 
             RowBox[{
              RowBox[{"FileDate", "[", "file", "]"}], ",", 
              RowBox[{"FileDate", "[", "dfile", "]"}]}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Length", "[", "orig", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"10", "^", 
           RowBox[{"Round", "[", 
            RowBox[{"Log10", "[", 
             RowBox[{"Max", "@", 
              RowBox[{"orig", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"MinMax", "[", "mags", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Union", "[", "mags", "]"}], "//", "Differences"}], "//", 
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", ".000001"}], "]"}], "&"}]}], "//", "Min"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "SpanFromLeft"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"grd", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"Sort", "@", 
             RowBox[{"Tally", "[", "mags", "]"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m_", ",", "n_"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"Reverse", "@", 
                RowBox[{"Accumulate", "@", 
                 RowBox[{"Reverse", "@", "n"}]}]}]}], "}"}], "]"}]}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"Fit", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"grd", ",", 
               RowBox[{"{", 
                RowBox[{"_", ",", "0"}], "}"}]}], "]"}], "/.", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m_", ",", "n_"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"Log", "[", "n", "]"}]}], "}"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "mag", " ", "freq", " ", "distributions", " ", "and", " ", "b"}], 
           "-", "value"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ListLogPlot", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Legended", "[", 
              RowBox[{
               RowBox[{"Tally", "[", "mags", "]"}], ",", 
               RowBox[{"Placed", "[", 
                RowBox[{"\"\<Events number\>\"", ",", "Above"}], "]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Legended", "[", 
              RowBox[{"grd", ",", 
               RowBox[{"Placed", "[", 
                RowBox[{"\"\<Cumulative number\>\"", ",", "Above"}], "]"}]}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Filling", "\[Rule]", "0"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"False", ",", "True"}], "}"}]}], ",", " ", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<b-value: ``\>\"", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"res", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "/", 
               RowBox[{"Log", "[", "10", "]"}]}]}], "]"}]}], ",", " ", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Dotted", ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", 
                   RowBox[{"(", 
                    RowBox[{"res", "/.", 
                    RowBox[{"x", "\[Rule]", "#"}]}], ")"}]}], "}"}], "&"}], "/@", 
                RowBox[{"MinMax", "[", "mags", "]"}]}], "]"}]}], "}"}]}]}], 
          "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Histogram", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"orig", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
            "Differences"}], ",", 
           RowBox[{
           "PlotLabel", "\[Rule]", 
            "\"\<Interevent times distribution\>\""}]}], "]"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ListLogLinearPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"loghistbins", "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"y", "-", 
               RowBox[{"Log10", "@", 
                RowBox[{"PDF", "[", 
                 RowBox[{
                  RowBox[{"ExponentialDistribution", "[", 
                   RowBox[{"u", "/.", "expfit"}], "]"}], ",", "x"}], 
                 "]"}]}]}]}], "}"}]}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
          RowBox[{"Joined", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
          RowBox[{
          "PlotLabel", "->", 
           "\"\<distance of \!\(\*SubscriptBox[\(log\), \(10\)]\) \
of\\ninterevent times bin counts\\n from exponential distr\>\""}]}], "]"}]}], 
       "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "All"}], ",", 
    RowBox[{"Alignment", "\[Rule]", "Center"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.83969466977108*^9, 3.839694670290978*^9}, {
   3.839694726478065*^9, 3.83969475469457*^9}, {3.839694950323979*^9, 
   3.839695000031797*^9}, 3.8396968360687647`*^9, {3.839697042149746*^9, 
   3.839697060661435*^9}, {3.83969751649699*^9, 3.8396975476624527`*^9}, {
   3.8396975968685293`*^9, 3.839697620068404*^9}, {3.839697677172276*^9, 
   3.839697735863867*^9}, 3.8396979567794724`*^9, {3.839698180567061*^9, 
   3.839698186558441*^9}, {3.83976100605927*^9, 3.839761068868993*^9}, {
   3.839761245416794*^9, 3.8397612565185757`*^9}, {3.839766243403491*^9, 
   3.839766252949724*^9}, {3.839768215576836*^9, 3.839768216596037*^9}, {
   3.839768387643055*^9, 3.839768393859398*^9}, {3.839768789399537*^9, 
   3.839768825816584*^9}, {3.839768960323925*^9, 3.839768967676515*^9}, {
   3.839769014564748*^9, 3.839769025937204*^9}, {3.839769097181294*^9, 
   3.839769141975724*^9}, {3.839769253000575*^9, 3.839769281235423*^9}, {
   3.839769656983532*^9, 3.839769657634809*^9}, {3.8397697299899406`*^9, 
   3.839769779577787*^9}, {3.839770041448097*^9, 3.839770043955515*^9}, 
   3.8397708963116903`*^9, 3.8397711885163507`*^9, {3.840172249808386*^9, 
   3.840172290999078*^9}, {3.840361450010396*^9, 3.8403614885412607`*^9}, {
   3.840361593211385*^9, 3.8403616626977663`*^9}, {3.840361766000002*^9, 
   3.8403618836595078`*^9}, {3.840361916021652*^9, 3.840362024407978*^9}, {
   3.8403620675334063`*^9, 3.840362149498901*^9}, {3.840362201676795*^9, 
   3.840362413948094*^9}, {3.840362460838985*^9, 3.840362603158454*^9}, {
   3.840362653022738*^9, 3.840362654345154*^9}, {3.8403631593879833`*^9, 
   3.84036317521216*^9}, {3.840363205462111*^9, 3.840363207327271*^9}, {
   3.840363264538988*^9, 3.840363321689106*^9}, {3.84051577324683*^9, 
   3.840515869498361*^9}, {3.8405319483771877`*^9, 3.840532016503757*^9}, {
   3.840534980295704*^9, 3.840534997377584*^9}, {3.841400202241448*^9, 
   3.841400219857437*^9}},ExpressionUUID->"2dac22e2-5c33-49cd-81f2-\
635db2cc51d6"]
}, Closed]],

Cell[CellGroupData[{

Cell["new (function defined) cell", "Subsubsection",
 CellChangeTimes->{{3.8414003171431923`*^9, 3.841400323621187*^9}, {
  3.841400403174094*^9, 
  3.841400416077911*^9}},ExpressionUUID->"16d073b8-b293-4c81-9249-\
a4b713037a15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mags", "=", 
   RowBox[{"orig", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"infodata", "[", "orig", "]"}], "\n", 
 RowBox[{
  RowBox[{"StringForm", "[", 
   RowBox[{"\"\<Time span catalog: from `` to `` years\>\"", ",", 
    RowBox[{
     RowBox[{"cattspan", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Floor", "[", 
         RowBox[{"orig", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"orig", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}],
        "}"}]}], ";", " ", 
     RowBox[{"cattspan", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"cattspan", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Row", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"raw", "\[LeftDoubleBracket]", 
         RowBox[{";;", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"raw", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "3"}], ";;"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
      RowBox[{"ItemSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", " ", "4"}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Spacer", "[", "30", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"orig", "\[LeftDoubleBracket]", 
            RowBox[{";;", "3"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"orig", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"-", "3"}], ";;"}], "\[RightDoubleBracket]"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t_", "?", "NumberQ"}], ",", "p_List", ",", 
            RowBox[{"m_", "?", "NumberQ"}], ",", "id_Integer"}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"Sequence", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], ",", "t", ",", 
                 "SpanFromAbove"}], "]"}], ",", 
               RowBox[{
               "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], ",", "m", ",", 
                 "SpanFromAbove"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], ",", "id", ",", 
                 "SpanFromAbove"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", ",", "1"}], "]"}], ",", 
      RowBox[{"ItemSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", "1"}], "}"}]}], ",", 
      RowBox[{"Frame", "\[Rule]", "All"}], ",", 
      RowBox[{"Alignment", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Center", ",", "Center"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.83969466977108*^9, 3.839694670290978*^9}, {
   3.839694726478065*^9, 3.83969475469457*^9}, {3.839694950323979*^9, 
   3.839695000031797*^9}, 3.8396968360687647`*^9, {3.839697042149746*^9, 
   3.839697060661435*^9}, {3.83969751649699*^9, 3.8396975476624527`*^9}, {
   3.8396975968685293`*^9, 3.839697620068404*^9}, {3.839697677172276*^9, 
   3.839697735863867*^9}, 3.8396979567794724`*^9, {3.839698180567061*^9, 
   3.839698186558441*^9}, {3.83976100605927*^9, 3.839761068868993*^9}, {
   3.839761245416794*^9, 3.8397612565185757`*^9}, {3.839766243403491*^9, 
   3.839766252949724*^9}, {3.839768215576836*^9, 3.839768216596037*^9}, {
   3.839768387643055*^9, 3.839768393859398*^9}, {3.839768789399537*^9, 
   3.839768825816584*^9}, {3.839768960323925*^9, 3.839768967676515*^9}, {
   3.839769014564748*^9, 3.839769025937204*^9}, {3.839769097181294*^9, 
   3.839769141975724*^9}, {3.839769253000575*^9, 3.839769281235423*^9}, {
   3.839769656983532*^9, 3.839769657634809*^9}, {3.8397697299899406`*^9, 
   3.839769779577787*^9}, {3.839770041448097*^9, 3.839770043955515*^9}, 
   3.8397708963116903`*^9, 3.8397711885163507`*^9, {3.840172249808386*^9, 
   3.840172290999078*^9}, {3.840361450010396*^9, 3.8403614885412607`*^9}, {
   3.840361593211385*^9, 3.8403616626977663`*^9}, {3.840361766000002*^9, 
   3.8403618836595078`*^9}, {3.840361916021652*^9, 3.840362024407978*^9}, {
   3.8403620675334063`*^9, 3.840362149498901*^9}, {3.840362201676795*^9, 
   3.840362413948094*^9}, {3.840362460838985*^9, 3.840362603158454*^9}, {
   3.840362653022738*^9, 3.840362654345154*^9}, {3.8403631593879833`*^9, 
   3.84036317521216*^9}, {3.840363205462111*^9, 3.840363207327271*^9}, {
   3.840363264538988*^9, 3.840363321689106*^9}, {3.84051577324683*^9, 
   3.840515869498361*^9}, {3.8405319483771877`*^9, 3.840532016503757*^9}, {
   3.840534980295704*^9, 3.840534997377584*^9}, {3.841400202241448*^9, 
   3.8414002263677473`*^9}, {3.842950340566388*^9, 3.842950348822507*^9}, {
   3.842950477071697*^9, 3.842950485077322*^9}, {3.875597262408173*^9, 
   3.8755972668334217`*^9}, 3.875597796647892*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"b740fd49-2e43-483f-b1dd-95dc9c95132a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3) Interactive Panel", "Subsection",
 CellChangeTimes->{{3.8396738342805862`*^9, 3.8396738459168453`*^9}, {
  3.839782349323394*^9, 
  3.839782351721727*^9}},ExpressionUUID->"beb23643-7bec-4ebe-91e6-\
692fb9311777"],

Cell["this cell launches the main interactive data analysis panel", "Text",
 CellChangeTimes->{{3.839771481797944*^9, 
  3.839771526197939*^9}},ExpressionUUID->"17cd7e79-31f1-4c0e-a694-\
1502552c3799"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", "orig"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cattspan", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{"orig", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cin_", "?", "NumberQ"}], ",", 
        RowBox[{"cout_", "?", "NumberQ"}]}], "}"}], "\[RuleDelayed]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"timespanorder", "=", 
         RowBox[{"10", "^", 
          RowBox[{"Floor", "@", 
           RowBox[{"Log10", "@", 
            RowBox[{"Abs", "[", 
             RowBox[{"cout", "-", "cin"}], "]"}]}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{"cin", ",", "timespanorder"}], "]"}], ",", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"cout", ",", "timespanorder"}], "]"}]}], "}"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"multipletti", "=", 
    RowBox[{"{", "}"}]}], ";", 
   RowBox[{"n", "=", "1"}], ";", 
   RowBox[{"out", "=", "file"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "currmultip", " ", "must", " ", "be", " ", "set", " ", "to", " ", "1", 
     " ", "when", " ", "randomizing", " ", "and", " ", "when", " ", 
     "choosing", " ", "randomized", " ", "catalog"}], ",", " ", 
    RowBox[{
     RowBox[{"before", " ", "'"}], 
     RowBox[{"clustaction", "'"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"currmultip", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fl3d", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ts", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "10"}], "]"}]}], ";", 
  RowBox[{"nts", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "10"}], "]"}]}], ";", 
  RowBox[{"catalogo", "=", "0"}], ";", 
  RowBox[{"rj", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"amag", ",", "amagL", ",", "amagH", ",", "arem", ",", "arad"}], 
     "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<N/A\>\"", ",", "\"\<N/A\>\"", ",", "\"\<N/A\>\"", ",", 
      "\"\<N/A\>\"", ",", "\"\<N/A\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"outcdf", "=", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
     "clusterizzazione", " ", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tspan", "=", "timespan"}], ";", 
     RowBox[{"td", "=", "t"}], ";", 
     RowBox[{"(*", 
      RowBox[{"**", 
       RowBox[{"*", " ", "DEBUG"}]}], " ", "****)"}], "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"scelta", " ", "catalogo"}], " ", "*)"}],
      Background->RGBColor[0.9, 1, 1]], "\[IndentingNewLine]", 
     RowBox[{"clustaction", "=", 
      RowBox[{
       StyleBox["Hold",
        Background->RGBColor[0.9, 1, 1]], 
       StyleBox["[",
        Background->RGBColor[0.9, 1, 1]], 
       StyleBox["\[IndentingNewLine]",
        Background->RGBColor[0.9, 1, 1]], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"ricalcola", " ", "gli", " ", "indici", " ", "DOPO", " ", 
         RowBox[{"l", "'"}], "eventuale", " ", "prefiltraggio"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        StyleBox[
         RowBox[{"datai", "=", "1"}],
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[";",
         Background->RGBColor[0.9, 1, 1]], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"localmag", ",", "\[IndentingNewLine]", 
          RowBox[{"data", "=", "orig"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Beep", "[", "]"}], ";", 
           RowBox[{"data", "=", 
            RowBox[{
             StyleBox["Table",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["[",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             RowBox[{
              StyleBox[
               RowBox[{"Append", "[", 
                RowBox[{"newcat", ",", 
                 RowBox[{"datai", "++"}]}], "]"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[",",
               Background->RGBColor[0.9, 1, 1]], 
              RowBox[{
               StyleBox["{",
                Background->RGBColor[0.9, 1, 1]], 
               RowBox[{
                StyleBox["newcat",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[",",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                RowBox[{
                 StyleBox["Cases",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["[",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 RowBox[{
                  StyleBox[
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"catalogo", "==", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Most", "/@", "orig"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "reconstruct", " ", "randomized", " ", "catalog"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "ts", "\[LeftDoubleBracket]", "catalogo", 
                    "\[RightDoubleBracket]"}], "}"}], ",", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "orig", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}], "]"}], ",",
                     "First"}], "]"}]}], "]"}],
                   Background->RGBColor[0.9, 1, 1]], 
                  StyleBox[",",
                   Background->RGBColor[0.9, 1, 1]], 
                  RowBox[{
                   StyleBox[
                    RowBox[{"{", 
                    RowBox[{"t_", ",", "x_", ",", "m_"}], "}"}],
                    Background->RGBColor[0.9, 1, 1]], 
                   StyleBox["/;",
                    Background->RGBColor[0.9, 1, 1]], 
                   RowBox[{
                    RowBox[{"magthresh", 
                    StyleBox["-",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[CapitalDelta]magL",
                    Background->RGBColor[0.9, 1, 1]]}], 
                    StyleBox["\[LessEqual]",
                    Background->RGBColor[0.9, 1, 1]], "m"}]}]}], "]"}]}], 
               "}"}]}], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["]",
              Background->RGBColor[0.9, 1, 1]]}]}]}]}], 
         StyleBox["\[IndentingNewLine]",
          Background->RGBColor[0.9, 1, 1]], 
         StyleBox["]",
          Background->RGBColor[0.9, 1, 1]]}], 
        StyleBox[";",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[
         RowBox[{"multipletti", "=", 
          RowBox[{"{", "}"}]}],
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[";",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[
         RowBox[{"mp", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "data", "]"}], "]"}]}],
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox[";",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        RowBox[{
         StyleBox["clusters",
          Background->RGBColor[0.9, 1, 1]], 
         StyleBox["=",
          Background->RGBColor[0.9, 1, 1]], 
         RowBox[{
          RowBox[{
           StyleBox["Reap",
            Background->RGBColor[0.9, 1, 1]], 
           StyleBox["[",
            Background->RGBColor[0.9, 1, 1]], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[0.9, 1, 1]], 
           RowBox[{
            StyleBox["While",
             Background->RGBColor[0.9, 1, 1]], 
            StyleBox["[",
             Background->RGBColor[0.9, 1, 1]], 
            RowBox[{
             StyleBox[
              RowBox[{
               RowBox[{"Length", "[", "mp", "]"}], ">", "0"}],
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox[",",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox[
              RowBox[{"(*", 
               RowBox[{"**", 
                RowBox[{"*", " ", "PIVOT"}]}], " ", "****)"}],
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.9, 1, 1]], 
             RowBox[{
              StyleBox[
               RowBox[{"While", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "<", 
                   RowBox[{"Length", "[", "data", "]"}]}], "&&", 
                  RowBox[{
                   RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], "<", "magthresh"}]}], ",", 
                 RowBox[{"n", "++"}]}], "]"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"j", "=", 
                RowBox[{
                "mp", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}]}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"(*", " ", 
                RowBox[{
                "elimino", " ", "gli", " ", "indici", " ", "degli", " ", 
                 "eventi", " ", "precedenti", " ", "al", " ", "pivot", " ", 
                 "mp", " ", "e", " ", "resetto", " ", "n"}], " ", "*)"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"mp", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{"mp", ",", 
                  RowBox[{"n", "-", "1"}]}], "]"}]}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"n", "=", "1"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"StringForm", "[", 
                  RowBox[{"\"\<primi 10 mp: ``\>\"", ",", 
                   RowBox[{"mp", "\[LeftDoubleBracket]", 
                    RowBox[{";;", "10"}], "\[RightDoubleBracket]"}]}], "]"}], 
                 ";"}], "*)"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"Sow", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{
                   "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "1"}], "]"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"poolflag", "===", "\"\< OLD \>\""}], ",", 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[
                 RowBox[{"(*", " ", 
                  RowBox[{"TEMPO", " ", "CONNESSI"}], " ", "*)"}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[
                 RowBox[{
                  RowBox[{
                   RowBox[{"pool", "=", 
                    RowBox[{"{", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}]}], "]"}], "}"}]}], ";", 
                   RowBox[{"intpool", "=", 
                    RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
                  RowBox[{"While", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "data", "]"}], "-", "1"}]}], ")"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"liu", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"IntervalUnion", "@@", "intpool"}], "]"}]}], " ", 
                    ")"}], "<", "2"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"intpool", ",", 
                    RowBox[{"Interval", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"gkt", "[", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"pool", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "]"}]}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"n", "++"}]}]}], "]"}]}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[",",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[
                 RowBox[{"(*", " ", 
                  RowBox[{"TEMPO", " ", "CONNESSI", " ", "2"}], " ", "*)"}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                RowBox[{
                 StyleBox[
                  RowBox[{"pool", "=", 
                   RowBox[{"{", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}]}], "]"}], "}"}]}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 RowBox[{
                  StyleBox["intpool",
                   Background->RGBColor[0.9, 1, 1]], 
                  StyleBox["=",
                   Background->RGBColor[0.9, 1, 1]], 
                  RowBox[{
                   StyleBox["{",
                    Background->RGBColor[0.9, 1, 1]], 
                   RowBox[{"Interval", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"gkt", "[", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], "]"}], 
                   "}"}]}], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"While", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "data", "]"}], "-", "1"}]}], ")"}],
                     "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"IntervalUnion", "@@", 
                    RowBox[{"(", 
                    RowBox[{"nextintpool", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"intpool", ",", 
                    RowBox[{"Interval", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"gkt", "[", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], "]"}]}], 
                    "]"}]}], ")"}]}], "]"}], " ", "<", "2"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"n", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"intpool", "=", "nextintpool"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"pool", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "mp", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], 
                   "\[IndentingNewLine]", "]"}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"n", "++"}],
                  Background->RGBColor[0.9, 1, 1]]}]}], 
               StyleBox["\[IndentingNewLine]",
                Background->RGBColor[0.9, 1, 1]], 
               StyleBox["]",
                Background->RGBColor[0.9, 1, 1]]}], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "n", " ", "qui", " ", "punta", " ", "alla", " ", "fine", " ",
                   "degli", " ", "eventi", " ", "connessi", " ", "solo", " ", 
                  "temporalmente"}], ",", " ", 
                 RowBox[{
                  RowBox[{
                  "non", " ", "elimino", " ", "gli", " ", "indici", " ", 
                   "corrispondenti", " ", "voglio", " ", "quelli", " ", 
                   "spazio"}], "-", "temporali"}]}], " ", "*)"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"connessi", "=", 
                RowBox[{"intersezioni", "=", 
                 RowBox[{"gkconnected", "=", 
                  RowBox[{"{", "}"}]}]}]}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              RowBox[{
               StyleBox["If",
                Background->RGBColor[0.9, 1, 1]], 
               StyleBox["[",
                Background->RGBColor[0.9, 1, 1]], 
               RowBox[{
                StyleBox[
                 RowBox[{
                  RowBox[{"Length", "[", "pool", "]"}], ">", "1"}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[",",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[
                 RowBox[{"(*", " ", 
                  RowBox[{
                  "filtraggio", " ", "parallelo", " ", "su", " ", "pool", " ",
                    "mediante", " ", "intersezione", " ", "iperspaziale", " ",
                    "secondo", " ", "GK", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "ipercilindri", " ", "di", " ", "base", " ", "sferica", 
                    " ", "e", " ", "altezza", " ", 
                    RowBox[{"gkt", "[", "mag", "]"}]}], ")"}], " ", "e", " ", 
                   "limite", " ", "di", " ", "\[CapitalDelta]mag"}], "*)"}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                RowBox[{
                 RowBox[{
                  StyleBox["intersezioni",
                   Background->RGBColor[0.9, 1, 1]], 
                  StyleBox["=",
                   Background->RGBColor[0.9, 1, 1]], 
                  RowBox[{
                   StyleBox[
                    RowBox[{"Subsets", "[", 
                    RowBox[{"pool", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}],
                    Background->RGBColor[0.9, 1, 1]], 
                   StyleBox["/.",
                    Background->RGBColor[0.9, 1, 1]], 
                   RowBox[{
                    StyleBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "n1_Integer", ",", "t1_", ",", "c1_", ",", "m1_", ",", 
                    "_"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "n2_Integer", ",", "t2_", ",", "c2_", ",", "m2_", ",", 
                    "_"}], "}"}]}], "}"}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[RuleDelayed]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["Rule",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["[",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox[
                    RowBox[{"{", 
                    RowBox[{"n1", ",", "n2"}], "}"}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["And",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["[",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"c1", ",", "c2"}], "]"}], "\[LessEqual]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"gkr", "[", "m1", "]"}], "+", 
                    RowBox[{"gkr", "[", "m2", "]"}]}], ")"}]}], ","}], "*)"}],
                    
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox[
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"c1", ",", "c2"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Switch", "[", 
                    RowBox[{"gkrad", ",", "\"\<1st\>\"", ",", 
                    RowBox[{"gkr", "[", "m1", "]"}], ",", "\"\<max\>\"", ",", 
                    
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"gkr", "[", "m1", "]"}], ",", 
                    RowBox[{"gkr", "[", "m2", "]"}]}], "]"}], ",", 
                    "\"\<sum\>\"", ",", 
                    RowBox[{
                    RowBox[{"gkr", "[", "m1", "]"}], "+", 
                    RowBox[{"gkr", "[", "m2", "]"}]}]}], "]"}]}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[
                    RowBox[{
                    RowBox[{"t2", "-", "t1"}], "\[LessEqual]", 
                    RowBox[{"gkt", "[", "m1", "]"}]}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
                    "m2"}], "]"}], "\[LessEqual]", "\[CapitalDelta]magthr"}], 
                    "*)"}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox[
                    RowBox[{"-", "\[CapitalDelta]magH"}],
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[LessEqual]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    RowBox[{
                    StyleBox["If",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["[",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["localmag",
                    Background->RGBColor[0.9, 1, 1]], ",", "m1", ",", 
                    StyleBox[" ",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "3"}], "\[RightDoubleBracket]"}],
                    Background->RGBColor[0.9, 1, 1]]}], 
                    StyleBox["]",
                    Background->RGBColor[0.9, 1, 1]]}], 
                    StyleBox["-",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["m2",
                    Background->RGBColor[0.9, 1, 1]]}], 
                    StyleBox["\[LessEqual]",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[CapitalDelta]magL",
                    Background->RGBColor[0.9, 1, 1]]}]}], 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["]",
                    Background->RGBColor[0.9, 1, 1]]}]}], 
                    StyleBox["]",
                    Background->RGBColor[0.9, 1, 1]]}]}]}]}], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"(*", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "qui", " ", "ho", " ", "il", " ", "pool", " ", "SOLO", 
                    " ", "di", " ", "eventi", " ", "connessi", " ", 
                    "spazio"}], "-", "temporalmente"}], ",", " ", 
                    RowBox[{"NO", " ", 
                    RowBox[{"mag", ":", " ", 
                    RowBox[{
                    "elimino", " ", "gli", " ", "elementi", " ", "di", " ", 
                    "questo", " ", "pool", " ", "da", " ", "mp"}]}]}]}], " ", 
                   "*)"}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"gkconnected", "=", 
                   RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Subsets", "[", 
                    RowBox[{"pool", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "n1_Integer", ",", "t1_", ",", "c1_", ",", "m1_", ",", 
                    "_"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "n2_Integer", ",", "t2_", ",", "c2_", ",", "m2_", ",", 
                    "_"}], "}"}]}], "}"}], "\[RuleDelayed]", 
                    RowBox[{"List", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n1", ",", "n2"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"And", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"c1", ",", "c2"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Switch", "[", 
                    RowBox[{"gkrad", ",", "\"\<1st\>\"", ",", 
                    RowBox[{"gkr", "[", "m1", "]"}], ",", "\"\<max\>\"", ",", 
                    
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"gkr", "[", "m1", "]"}], ",", 
                    RowBox[{"gkr", "[", "m2", "]"}]}], "]"}], ",", 
                    "\"\<sum\>\"", ",", 
                    RowBox[{
                    RowBox[{"gkr", "[", "m1", "]"}], "+", 
                    RowBox[{"gkr", "[", "m2", "]"}]}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"t2", "-", "t1"}], "\[LessEqual]", 
                    RowBox[{"gkt", "[", "m1", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], "]"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"e1_", ",", "e2_"}], "}"}], ",", "True"}], "}"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"e1", ",", "e2"}], "}"}]}]}], "]"}]}]}]}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"graph", "=", 
                   RowBox[{"Graph", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{"intersezioni", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"e1_", ",", "e2_"}], "}"}], "\[Rule]", "True"}], 
                    ")"}], "\[RuleDelayed]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"e1", ",", "e2"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], 
                    "]"}]}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "prende", " ", "il", " ", "solo", " ", "cluster", " ", 
                    "che", " ", "parte", " ", "da", " ", "j", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "se", " ", "j", " ", "\[EGrave]", " ", "stato", " ", 
                    "eliminato", " ", "non", " ", 
                    RowBox[{"c", "'"}], "\[EGrave]", " ", "uscita"}], ")"}]}],
                    " ", "*)"}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"connessi", "=", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{
                    "WeaklyConnectedComponents", "[", "graph", "]"}]}], ",", 
                    "j"}], "]"}], ",", 
                    RowBox[{"VertexOutComponent", "[", 
                    RowBox[{"graph", ",", "j"}], "]"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}],
                  Background->RGBColor[0.9, 1, 1]]}]}], 
               StyleBox["]",
                Background->RGBColor[0.9, 1, 1]]}], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              RowBox[{
               StyleBox["If",
                Background->RGBColor[0.9, 1, 1]], 
               StyleBox["[",
                Background->RGBColor[0.9, 1, 1]], 
               RowBox[{
                StyleBox[
                 RowBox[{
                  RowBox[{"Length", "[", "connessi", "]"}], ">", "1"}],
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox[",",
                 Background->RGBColor[0.9, 1, 1]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[0.9, 1, 1]], 
                RowBox[{
                 StyleBox[
                  RowBox[{"Sow", "[", 
                   RowBox[{"connessi", ",", "2"}], "]"}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[";",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox[
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Sow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"j", ",", "graph", ",", "gkconnected"}], "}"}], 
                    ",", "3"}], "]"}], ";"}], "*)"}],
                  Background->RGBColor[0.9, 1, 1]], 
                 StyleBox["\[IndentingNewLine]",
                  Background->RGBColor[0.9, 1, 1]], 
                 RowBox[{
                  StyleBox["Sow",
                   Background->RGBColor[0.9, 1, 1]], 
                  StyleBox["[",
                   Background->RGBColor[0.9, 1, 1]], 
                  RowBox[{
                   RowBox[{
                    StyleBox["{",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["j",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["pool",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["gkconnected",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["intersezioni",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox[",",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["graph",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["/.",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["VertexStyle",
                    Background->RGBColor[0.9, 1, 1]], 
                    StyleBox["\[Rule]",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    StyleBox["(",
                    Background->RGBColor[0.9, 1, 1]], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[Rule]", "Orange"}], ")"}], "&"}], "/@", 
                    "connessi"}], ")"}]}]}]}], "}"}], ",", "3"}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}], ";", 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"(*", " ", 
                RowBox[{
                "nel", " ", "caso", " ", "si", " ", "voglia", " ", 
                 "scegliere", " ", "se", " ", "eliminare", " ", "GK", " ", 
                 "o", " ", "GKM", 
                 RowBox[{"(", "graph", ")"}]}], " ", "*)"}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"mp", "=", 
                  RowBox[{"Complement", "[", 
                   RowBox[{"mp", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cflag", "\[Equal]", "gk"}], ",", "gkconnected", 
                    ",", 
                    RowBox[{"VertexList", "[", "graph", "]"}]}], "]"}], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], "*)"}],
               Background->RGBColor[0.9, 1, 1]], "\[IndentingNewLine]", 
              StyleBox[
               RowBox[{"mp", "=", 
                RowBox[{"Complement", "[", 
                 RowBox[{"mp", ",", "\[IndentingNewLine]", 
                  RowBox[{"Switch", "[", 
                   RowBox[{
                   "removed", ",", "\"\<GK\>\"", ",", "gkconnected", ",", 
                    "\"\<GK-Mag\>\"", ",", 
                    RowBox[{"VertexList", "[", "graph", "]"}], ",", 
                    "\"\<None\>\"", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
                  RowBox[{"{", "j", "}"}]}], "]"}]}],
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[";",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.9, 1, 1]], 
              StyleBox[
               RowBox[{"n", "=", "1"}],
               Background->RGBColor[0.9, 1, 1]]}]}], 
            StyleBox[" ",
             Background->RGBColor[0.9, 1, 1]], 
            StyleBox[
             RowBox[{"(*", " ", 
              RowBox[{
              "elimina", " ", "da", " ", "mp", " ", "gli", " ", "indici", " ",
                "degli", " ", "eventi", " ", "gk", " ", "connessi"}], " ", 
              "*)"}],
             Background->RGBColor[0.9, 1, 1]], 
            StyleBox["\[IndentingNewLine]",
             Background->RGBColor[0.9, 1, 1]], 
            StyleBox["]",
             Background->RGBColor[0.9, 1, 1]]}], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[0.9, 1, 1]], 
           StyleBox["]",
            Background->RGBColor[0.9, 1, 1]]}], 
          StyleBox["\[LeftDoubleBracket]",
           Background->RGBColor[0.9, 1, 1]], 
          StyleBox["2",
           Background->RGBColor[0.9, 1, 1]], 
          StyleBox["\[RightDoubleBracket]",
           Background->RGBColor[0.9, 1, 1]]}]}], 
        StyleBox[";",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[0.9, 1, 1]], 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "clusters", "]"}], "\[Equal]", "1"}], ",", 
          " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "SE", " ", "non", " ", "ci", " ", "sono", " ", "multipletti"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<NO multipletti\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"clusters", "=", 
            RowBox[{"{", 
             RowBox[{"clusters", ",", 
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"multipletti", "=", 
            RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "SE", " ", "ci", " ", "sono", " ", "elimina", " ", "gli", " ", 
             "eventuali", " ", "sub"}], "-", 
            RowBox[{
             RowBox[{"clusters", " ", "!!"}], "!"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"es", ".", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"59", ",", "60", ",", "23", ",", "42"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"108", ",", "109", ",", 
                 StyleBox["111",
                  FontColor->RGBColor[0.5, 0, 0.5]], 
                 StyleBox[",",
                  FontColor->RGBColor[0.5, 0, 0.5]], 
                 StyleBox["116",
                  FontColor->RGBColor[0.5, 0, 0.5]]}], "}"}], ",", 
               StyleBox[
                RowBox[{"{", 
                 RowBox[{"111", ",", "116"}], "}"}],
                FontColor->RGBColor[0.5, 0, 0.5]], ",", 
               RowBox[{"{", 
                RowBox[{"123", ",", "124"}], "}"}]}], "}"}], " ", 
             "\[LongRightArrow]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"59", ",", "60", ",", "23", ",", "42"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"108", ",", "109", ",", "111", ",", "116"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"123", ",", "124"}], "}"}]}], "}"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"multipletti", "=", 
             RowBox[{"Most", "@", 
              RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{
                   RowBox[{
                   "clusters", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "2", ",", "1", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}], "/.", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "cl1__Integer", "}"}], ",", 
                    RowBox[{"{", "cl2__Integer", "}"}]}], "}"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{
                    RowBox[{"{", "cl1", "}"}], ",", 
                    RowBox[{"{", "cl2", "}"}]}], "]"}], ",", "Nothing", ",", 
                    RowBox[{"{", "cl2", "}"}]}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"clusters", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"multipletti", "=", 
            RowBox[{
            "clusters", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "=", 
            RowBox[{"clusters", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1", ",", "2", ",", "1", ",", "2"}], "]"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       StyleBox["\[IndentingNewLine]",
        Background->RGBColor[0.9, 1, 1]], 
       StyleBox["]",
        Background->RGBColor[0.9, 1, 1]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
       "clusterizzazione", " ", "**", "**", "**", "**", "**", "**", "**", "**",
        "**", "**"}], "****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "seleziona", " ", "i", " ", "soli", " ", "eventi", " ", "nella", " ", 
       "timespan", " ", "per", " ", "semplificare", " ", "i", " ", "conti"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"records", " ", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"data", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"t", "-", 
           RowBox[{"0.2", "*", 
            RowBox[{"10", "^", "timespan"}]}]}], "\[LessEqual]", 
          RowBox[{"First", "[", "x", "]"}], "<", 
          RowBox[{"t", "+", 
           RowBox[{"1.8", "*", 
            RowBox[{"10", "^", "timespan"}]}]}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"seleziona", " ", "i", " ", "soli", " ", "multipletti", " ", 
       RowBox[{"all", "'"}], "interno", " ", "del", " ", "timespan"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cluscelti", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"multipletti", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"SubsetQ", "[", 
            RowBox[{
             RowBox[{"records", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", "#"}], 
            "]"}], "&"}], ")"}]}]}], "]"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "nearest", " ", "functs", " ", "ai", " ", "tempi", " ", "dei", " ", 
       "clusters"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"coppie", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "#eventi"}], "}"}], " ", "per", " ", "ogni", 
       " ", "multipletto", " ", "trovato"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"clustimes", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "/.", 
           RowBox[{"i_Integer", "\[RuleDelayed]", 
            RowBox[{"data", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"Length", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
       "multipletti"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"nearest", " ", "functions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"multipletti", "\[NotEqual]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"nft", "=", 
          RowBox[{"Nearest", "[", "clustimes", "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nfti2", "=", 
         RowBox[{"Nearest", "[", 
          RowBox[{"clustimes", "\[Rule]", "\"\<Index\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"nfti", "=", 
           RowBox[{"Nearest", "[", 
            RowBox[{
             RowBox[{"clustimes", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
             "\[Rule]", "\"\<Index\>\""}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "estrae", " ", "il", " ", "multipletto", " ", "piu", " ", "vicino", 
          " ", "al", " ", "tempo", " ", "t", " ", "attuale", " ", "e", " ", 
          "mag", " ", "minima", " ", "indicizzato", " ", "in", " ", 
          "currmultip"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"multip", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"multipletti", "\[LeftDoubleBracket]", 
               RowBox[{"nfti", "[", "t", "]"}], "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"i_Integer", "\[RuleDelayed]", 
               RowBox[{
               "data", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], "//.", 
             RowBox[{
              RowBox[{"{", "dum_", "}"}], "\[RuleDelayed]", "dum"}]}], 
            "]"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"currmultip", "=", 
           RowBox[{"First", "@", 
            RowBox[{"nfti2", "[", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0"}], "}"}], "]"}]}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"multip", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "multipletti", "\[LeftDoubleBracket]", "currmultip", 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"i_Integer", "\[RuleDelayed]", 
             RowBox[{
             "data", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], "//.", 
           RowBox[{
            RowBox[{"{", "dum_", "}"}], "\[RuleDelayed]", "dum"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"multip", "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "grafica", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<`` (``)\>\"", ",", 
           RowBox[{"FileBaseName", "[", "file", "]"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"catalogo", "\[Equal]", "0"}], ",", "\"\<Original\>\"", 
             ",", 
             RowBox[{"catalogo", ">", "0"}], ",", 
             RowBox[{"\"\<Randomized \[Rule] \>\"", "<>", 
              RowBox[{
              "nts", "\[LeftDoubleBracket]", "catalogo", 
               "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<mags:`` \[Rule] `` events, magmin:`` \[Rule] `` events\>\"", 
           ",", 
           RowBox[{"MinMax", "[", 
            RowBox[{"orig", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], ",", 
           RowBox[{"Length", "[", "orig", "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"data", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Actual mag values: (``\[DoubleLongLeftArrow]``\
\[DoubleLongRightArrow]``) radius: ``, remove policy: ``\>\"", ",", "amagL", 
           ",", "amag", ",", "amagH", ",", "arad", ",", "arem"}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"view", ",", "\"\<3D plot\>\""}], "]"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"multipletti", "\[NotEqual]", " ", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<refers to \[FilledCircle]\>\"", ",", 
                    "SpanFromLeft"}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<tspan\>\"", ",", 
                    RowBox[{"-", 
                    RowBox[{"Subtract", "@@", 
                    RowBox[{"MinMax", "[", 
                    RowBox[{
                    "multip", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}]}]}], "}"}], ",", 
                    StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[1, 0.85, 0.85]], 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Data\>\"", ",", 
                    RowBox[{"DateString", "[", 
                    RowBox[{"QuantityMagnitude", "[", 
                    RowBox[{
                    RowBox[{"Quantity", "[", 
                    RowBox[{
                    RowBox[{"multip", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    "\"\<years\>\""}], "]"}], ",", "\"\<seconds\>\""}], "]"}],
                     "]"}]}], "}"}], ","}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<file\\nlines\>\"", ",", 
                    RowBox[{"TableForm", "@", 
                    RowBox[{
                    "multip", "\[LeftDoubleBracket]", "4", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<seq.\\nmag.\>\"", ",", 
                    RowBox[{"TableForm", "@", 
                    RowBox[{
                    "multip", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], 
                   "\[IndentingNewLine]", "}"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", 
               "]"}], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.88, 1, 0.88]], 
              StyleBox[",",
               Background->RGBColor[0.88, 1, 0.88]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[0.88, 1, 0.88]], 
              StyleBox[
               RowBox[{"Graphics3D", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"FaceForm", "[", "None", "]"}], ","}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"cyls", "=", 
                    RowBox[{"records", "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t_", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "mag_", 
                    ",", "id_"}], "}"}], "\[RuleDelayed]", 
                    RowBox[{"Which", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    "clusters", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "id"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Opacity", "[", ".05", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Blue", ",", 
                    RowBox[{"Opacity", "[", ".2", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"gkDisk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "t", ",", "mag", ",",
                     "id"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "cluscelti"}], ",", "id"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", ".05", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Opacity", "[", ".2", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"gkDisk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "t", ",", "mag", ",",
                     "id"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    "True", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", ".6", "]"}], ",", "Dotted"}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"FaceForm", "[", "None", "]"}], ",", 
                    RowBox[{"gkDisk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", "t", ",", "mag", ",",
                     "id"}], "]"}]}], "}"}]}], "}"}]}], "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", "Thick", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Hue", "[", 
                    RowBox[{"RandomReal", "[", "]"}], "]"}], ",", 
                    RowBox[{"Line", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"cluscelti", "/.", 
                    RowBox[{"i_Integer", "\[RuleDelayed]", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "Dotted", ",", 
                    RowBox[{"Line", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{"cpticlustersID", "/.", 
                    RowBox[{"i_Integer", "\[RuleDelayed]", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ")"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
                   "Red", ",", 
                   RowBox[{"PointSize", "[", ".02", "]"}], ",", 
                   RowBox[{"Point", "[", 
                    RowBox[{
                    RowBox[{"multip", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t_", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "y_", ",", "_"}], "}"}], ",", "__"}], 
                    "}"}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "t"}], "}"}]}]}], "]"}]}], 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "indicatore", " ", "cluster", " ", "con", " ", "INFO"}], 
                   " ", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
                 RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
                 RowBox[{"Axes", "\[Rule]", "True"}], ",", 
                 RowBox[{"BoxRatios", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", "1", ",", " ", "1.5"}], "}"}]}], 
                 ",", 
                 RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PlotRange", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t", "-", 
                    RowBox[{".2", "*", 
                    RowBox[{"10", "^", "timespan"}]}]}], ",", 
                    RowBox[{"t", "+", 
                    RowBox[{"1.8", "*", 
                    RowBox[{"10", "^", "timespan"}]}]}]}], "}"}]}], "}"}]}]}],
                 "]"}],
               Background->RGBColor[0.88, 1, 0.88]]}], 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[0.88, 1, 0.88]], 
             StyleBox["}",
              Background->RGBColor[0.88, 1, 0.88]]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"Dynamic", "@", 
            RowBox[{"Length", "[", "mp", "]"}]}], ",", 
           "\"\<Events to be analysed: \>\"", ",", "Left"}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"selected", " ", "cluster", " ", "info", " ", "line"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "multip", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{
              "\"\<cluster of `` events, Pivot Id/time: `` / ``, mag(s): ``\>\
\"", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"First", "[", "multip", "]"}], "]"}], ",", 
               RowBox[{"multip", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"multip", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", ".01"}], "]"}],
                ",", 
               RowBox[{"OpenerView", "[", 
                RowBox[{"Column", "/@", 
                 RowBox[{"TakeDrop", "[", 
                  RowBox[{
                   RowBox[{"multip", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}]}], 
                "]"}]}], "]"}], ",", "Red"}], "]"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"multipletti", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<No multiplets found for these parameters\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"FontSize", "\[Rule]", "24"}], ",", "Red"}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"EventHandler", "[", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListLogPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"clustimes", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "clustimes", "\[LeftDoubleBracket]", "currmultip", 
                   "\[RightDoubleBracket]"}], "}"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"cattspan", ",", "All"}], "}"}]}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "8"}]}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Red"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Filling", "\[Rule]", "Bottom"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Epilog", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Line", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "50"}], "}"}]}], "}"}], "]"}]}], 
                 "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"currmultip", "=", 
                 RowBox[{
                  RowBox[{"nfti2", "[", 
                   RowBox[{
                    RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], "/.", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "y_"}], "}"}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"Exp", "[", "y", "]"}]}], "}"}]}]}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                ";", 
                RowBox[{"t", "=", 
                 RowBox[{
                  RowBox[{
                  "clustimes", "\[LeftDoubleBracket]", "currmultip", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], ")"}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<Current multiplet index: `` \[Rule] ``\>\"", ",", 
             "currmultip", ",", 
             RowBox[{
             "clustimes", "\[LeftDoubleBracket]", "currmultip", 
              "\[RightDoubleBracket]"}]}], "]"}], ","}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"**", "**", "**", "**", "**", "**", "**", " ", "plot"}], 
           " ", "del", " ", "bar", " ", "chart", " ", 
           RowBox[{"temporale", " ", "**", "**", "**", "**", "**"}], "*", 
           RowBox[{"**", "*"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"view", ",", "\"\<m_Hist\>\""}], "]"}], "&&", 
            RowBox[{"multipletti", "\[NotEqual]", " ", 
             RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Labeled", "[", 
            RowBox[{
             RowBox[{"Histogram", "[", 
              RowBox[{
               RowBox[{"clustimes", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"Append", "[", 
                RowBox[{"cattspan", ",", "binsize"}], "]"}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "8"}]}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
               RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             "\"\<Multiplets occurrences over time (every binsize years)\>\"",
              ",", "Top"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"**", "**", "**", "**", "**"}], "*", 
           RowBox[{"**", 
            RowBox[{"*", " ", "plot", " ", "del", " ", "grafo", " ", 
             RowBox[{"decisionale", " ", "**", "**", "**", "**"}], "*", 
             RowBox[{"**", "**"}], "*"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"view", ",", "\"\<Graph\>\""}], "]"}], "&&", 
            RowBox[{"multipletti", "\[NotEqual]", " ", 
             RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "j1", ",", "pool1", ",", "gkc1", ",", "intsz1", ",", "gph1"}], 
              "}"}], "=", 
             RowBox[{"clusters", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "currmultip"}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"nfti", "[", "t", "]"}], "//.", 
                RowBox[{
                 RowBox[{"{", "dum_", "}"}], "\[RuleDelayed]", "dum"}]}], 
               "*)"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vcoords", "=", 
             RowBox[{"pool1", "/.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "i_Integer", ",", "t_", ",", "p_", ",", "m_", ",", "_"}], 
                "}"}], "\[RuleDelayed]", 
               RowBox[{"i", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "m"}], "}"}]}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vcols", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", "\[Rule]", "Orange"}], "}"}], "&"}], "/@", 
               RowBox[{"VertexOutComponent", "[", 
                RowBox[{"gph1", ",", "j1"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nodes", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"allnodes", "\[Equal]", "True"}], ",", 
               RowBox[{"pool1", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"VertexList", "[", "gph1", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"vdim", "=", 
             RowBox[{".05", " ", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"Divide", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Subtract", "@@", 
                    RowBox[{"MinMax", "[", "#", "]"}]}], "&"}], "/@", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"nodes", "/.", "vcoords"}], "]"}]}], ")"}]}], ",",
                 "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"cmag", "=", 
             RowBox[{"pool1", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Panel", "@", 
             RowBox[{"Row", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Graph", "[", 
                 RowBox[{"nodes", ",", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"intsz1", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"e1_", ",", "e2_"}], "}"}], "\[Rule]", "True"}], 
                    ")"}], "\[RuleDelayed]", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"e1", ",", "e2"}], "]"}]}]}], "]"}], ",", 
                  RowBox[{
                  "GraphLayout", "\[Rule]", "\"\<LinearEmbedding\>\""}], ",", 
                  
                  RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}], ",", 
                  RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
                  RowBox[{"VertexSize", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"j1", "\[Rule]", 
                    RowBox[{"2", " ", "vdim"}]}], ",", "vdim"}], "}"}]}], ",",
                   " ", 
                  RowBox[{"EdgeStyle", "\[Rule]", 
                   RowBox[{"Arrowheads", "[", ".025", "]"}]}], ",", 
                  RowBox[{"VertexStyle", "\[Rule]", "vcols"}], ",", 
                  RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                  RowBox[{"FrameTicks", "\[Rule]", "True"}], ",", 
                  RowBox[{"Prolog", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Orange", ",", 
                    RowBox[{"il", "[", 
                    RowBox[{"cmag", "+", "\[CapitalDelta]magH"}], "]"}], ",", 
                    
                    RowBox[{"il", "[", 
                    RowBox[{"cmag", "-", "\[CapitalDelta]magL"}], "]"}], ",", 
                    
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"j1", "/.", "vcoords"}], "]"}], ",", 
                    RowBox[{"cmag", "-", "\[CapitalDelta]magH"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"First", "[", 
                    RowBox[{"j1", "/.", "vcoords"}], "]"}], ",", 
                    RowBox[{"cmag", "+", "\[CapitalDelta]magH"}]}], "}"}]}], 
                    "}"}], "]"}], ",", "Dashed", ",", "Black", ",", 
                    RowBox[{"il", "[", "magthresh", "]"}]}], "}"}]}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "540"}]}], "]"}], ",", 
                RowBox[{"Spacer", "[", "10", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Show", "[", 
                 RowBox[{"gph1", ",", 
                  RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}], 
              "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Grid", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"StringForm", "[", 
                    StyleBox[
                    RowBox[{
                    "\"\<Mag thr: ``, \[CapitalDelta]m-: ``, \
\[CapitalDelta]m+: ``\>\"", ",", "magthresh", ",", " ", "\[CapitalDelta]magL",
                     ",", " ", "\[CapitalDelta]magH"}],
                    Background->RGBColor[1, 0.9, 0.8]], 
                    StyleBox["]",
                    Background->RGBColor[1, 0.9, 0.8]]}], 
                   StyleBox[",",
                    Background->RGBColor[1, 0.9, 0.8]], 
                   StyleBox["SpanFromLeft",
                    Background->RGBColor[1, 0.9, 0.8]]}], 
                  StyleBox["}",
                   Background->RGBColor[1, 0.9, 0.8]]}], 
                 StyleBox["}",
                  Background->RGBColor[1, 0.9, 0.8]]}], 
                StyleBox[",",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<Removing events: ``\>\"", ",", "removed"}], 
                    "]"}], ",", "SpanFromLeft"}], "}"}], "}"}],
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[",",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"StringForm", "[", 
                    RowBox[{"\"\<`` clusters generated\>\"", ",", 
                    RowBox[{"Length", "[", "multipletti", "]"}]}], "]"}], ",",
                     "SpanFromLeft"}], "}"}], "}"}],
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[",",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<elements\>\"", ",", "\"\<clusters count\>\""}], "}"}],
                   "}"}],
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[",",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox["\[IndentingNewLine]",
                 Background->RGBColor[1, 0.9, 0.8]], 
                StyleBox[
                 RowBox[{"Sort", "[", 
                  RowBox[{"Tally", "[", 
                   RowBox[{"Length", "/@", "multipletti"}], "]"}], "]"}],
                 Background->RGBColor[1, 0.9, 0.8]]}], 
               StyleBox["\[IndentingNewLine]",
                Background->RGBColor[1, 0.9, 0.8]], 
               StyleBox["]",
                Background->RGBColor[1, 0.9, 0.8]]}], 
              StyleBox[",",
               Background->RGBColor[1, 0.9, 0.8]], 
              StyleBox[
               RowBox[{"Frame", "\[Rule]", "All"}],
               Background->RGBColor[1, 0.9, 0.8]]}], 
             StyleBox["]",
              Background->RGBColor[1, 0.9, 0.8]]}], 
            StyleBox[",",
             Background->RGBColor[1, 0.9, 0.8]], 
            StyleBox[
             RowBox[{"Spacer", "[", "30", "]"}],
             Background->RGBColor[1, 0.9, 0.8]], 
            StyleBox[",",
             Background->RGBColor[1, 0.9, 0.8]], 
            StyleBox["\[IndentingNewLine]",
             Background->RGBColor[1, 0.9, 0.8]], 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"multipletti", "\[NotEqual]", " ", 
               RowBox[{"{", "}"}]}], ",", 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[1, 0.9, 0.8]], 
              StyleBox[
               RowBox[{"Histogram", "[", 
                RowBox[{
                 RowBox[{"Length", "/@", "multipletti"}], ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"Ticks", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Range", "[", " ", 
                    RowBox[{
                    RowBox[{"Floor", "[", "#1", "]"}], ",", 
                    RowBox[{"Ceiling", "[", "#2", "]"}]}], "]"}], "&"}], ",", 
                    "Automatic"}], "}"}]}], ",", 
                 RowBox[{"AxesLabel", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<elements\>\"", ",", "\"\<clusters count\>\""}], 
                   "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}],
               Background->RGBColor[1, 0.9, 0.8]], 
              StyleBox[",",
               Background->RGBColor[1, 0.9, 0.8]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[1, 0.9, 0.8]], 
              StyleBox[
               RowBox[{"Spacer", "[", "300", "]"}],
               Background->RGBColor[1, 0.9, 0.8]]}], 
             StyleBox["]",
              Background->RGBColor[1, 0.9, 0.8]]}]}], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[1, 0.9, 0.8]], 
           StyleBox["}",
            Background->RGBColor[1, 0.9, 0.8]]}], 
          StyleBox["]",
           Background->RGBColor[1, 0.9, 0.8]]}], 
         StyleBox[",",
          Background->RGBColor[1, 0.9, 0.8]], 
         StyleBox["\[IndentingNewLine]",
          Background->RGBColor[1, 0.9, 0.8]], 
         StyleBox["\[IndentingNewLine]",
          Background->RGBColor[1, 0.9, 0.8]], 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{"RANDOMIZZAZIONE", " ", "Catalogo"}], " ", "*)"}],
          FontSize->24,
          Background->RGBColor[1, 0.9, 1]], 
         StyleBox["\[IndentingNewLine]",
          FontSize->24,
          Background->RGBColor[1, 0.9, 1]], 
         RowBox[{
          StyleBox["EventHandler",
           Background->RGBColor[1, 0.9, 1]], 
          StyleBox["[",
           Background->RGBColor[1, 0.9, 1]], 
          StyleBox["\[IndentingNewLine]",
           Background->RGBColor[1, 0.9, 1]], 
          StyleBox[" ",
           Background->RGBColor[1, 0.9, 1]], 
          RowBox[{
           RowBox[{
            StyleBox["Labeled",
             Background->RGBColor[1, 0.9, 0.8]], 
            StyleBox["[",
             Background->RGBColor[1, 0.9, 0.8]], 
            StyleBox[
             RowBox[{
              RowBox[{"SetterBar", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "catalogo", "]"}], ",", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", "rj", "]"}], ",", 
                  RowBox[{"0", "\[Rule]", "\"\<original\>\""}]}], "]"}]}], 
               "]"}], ",", "\"\<Catalog randomize:\>\"", ",", " ", "Left"}],
             Background->RGBColor[1, 0.9, 1]], 
            StyleBox["]",
             Background->RGBColor[1, 0.9, 1]]}], 
           StyleBox[",",
            Background->RGBColor[1, 0.9, 1]], 
           StyleBox["\[IndentingNewLine]",
            Background->RGBColor[1, 0.9, 1]], 
           RowBox[{
            StyleBox["\"\<MouseClicked\>\"",
             Background->RGBColor[1, 0.9, 1]], 
            StyleBox[":>",
             Background->RGBColor[1, 0.9, 1]], 
            RowBox[{
             StyleBox["{",
              Background->RGBColor[1, 0.9, 1]], 
             RowBox[{
              RowBox[{"currmultip", "=", "1"}], ";", 
              RowBox[{"ReleaseHold", "[", "clustaction", "]"}]}], "}"}]}], 
           ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
           RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], 
          StyleBox["\[IndentingNewLine]",
           Background->RGBColor[1, 0.9, 1]], 
          StyleBox["]",
           Background->RGBColor[1, 0.9, 1]]}], 
         StyleBox[",",
          Background->RGBColor[1, 0.9, 1]], 
         StyleBox["\[IndentingNewLine]",
          Background->RGBColor[1, 0.9, 1]], 
         StyleBox["\[IndentingNewLine]",
          Background->RGBColor[1, 0.9, 1]], 
         RowBox[{
          StyleBox["Row",
           Background->RGBColor[1, 0.9, 0.8]], 
          StyleBox["[",
           Background->RGBColor[1, 0.9, 0.8]], 
          RowBox[{
           StyleBox["{",
            Background->RGBColor[1, 0.9, 0.8]], 
           RowBox[{
            StyleBox[
             RowBox[{"Button", "[", 
              RowBox[{"\"\<Randomize\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"ri", "-", 
                  RowBox[{"calcolo", " ", "tempi"}]}], ",", " ", 
                 RowBox[{
                 "sostituzione", " ", "e", " ", "riordinamento", " ", "delle",
                   " ", "righe", " ", "del", " ", "catalogo"}]}], " ", "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"rj", "\[LessEqual]", "9"}], ",", 
                 RowBox[{
                  RowBox[{"trand", "=", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{"cattspan", ",", 
                    RowBox[{"Length", "@", "orig"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"data1", "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"SortBy", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Rest", "@", 
                    RowBox[{"Transpose", "[", "data", "]"}]}], ",", 
                    RowBox[{"trand", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", "100000", "}"}], ",", 
                    RowBox[{"Length", "@", "data"}]}], "]"}]}]}], "]"}], 
                    "]"}], ",", "First"}], "]"}], "]"}]}], ";"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"rj", "++"}], ";", 
                  RowBox[{
                   RowBox[{
                   "ts", "\[LeftDoubleBracket]", "rj", 
                    "\[RightDoubleBracket]"}], "=", "trand"}], ";", 
                  RowBox[{"catalogo", "=", "rj"}], ";", 
                  RowBox[{
                   RowBox[{
                   "nts", "\[LeftDoubleBracket]", "rj", 
                    "\[RightDoubleBracket]"}], "=", 
                   RowBox[{"FromCharacterCode", "[", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"65", ",", "90"}], "}"}], ",", "4"}], "]"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"currmultip", "=", "1"}], ";", 
                  RowBox[{"(*", " ", 
                   RowBox[{"avoid", " ", "error"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"ReleaseHold", "[", "clustaction", "]"}]}]}], "]"}],
                "\[IndentingNewLine]", ",", 
               RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}],
             Background->RGBColor[1, 0.9, 1]], 
            StyleBox[",",
             Background->RGBColor[1, 0.9, 1]], 
            StyleBox["\[IndentingNewLine]",
             Background->RGBColor[1, 0.9, 1]], 
            RowBox[{
             StyleBox["Button",
              Background->RGBColor[1, 0.9, 1]], 
             StyleBox["[",
              Background->RGBColor[1, 0.9, 1]], 
             RowBox[{
              StyleBox["\"\<Export\>\"",
               Background->RGBColor[1, 0.9, 1]], 
              StyleBox[",",
               Background->RGBColor[1, 0.9, 1]], 
              StyleBox["\[IndentingNewLine]",
               Background->RGBColor[1, 0.9, 1]], 
              RowBox[{"Export", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 StyleBox["out",
                  Background->RGBColor[1, 0.9, 1]], 
                 StyleBox["=",
                  Background->RGBColor[1, 0.9, 1]], 
                 RowBox[{
                  StyleBox["SystemDialogInput",
                   Background->RGBColor[1, 0.9, 1]], 
                  StyleBox["[",
                   Background->RGBColor[1, 0.9, 1]], 
                  RowBox[{
                   StyleBox["\"\<FileSave\>\"",
                    Background->RGBColor[1, 0.9, 1]], 
                   StyleBox[",",
                    Background->RGBColor[1, 0.9, 1]], 
                   StyleBox["\[IndentingNewLine]",
                    Background->RGBColor[1, 0.9, 1]], 
                   RowBox[{
                    RowBox[{
                    StyleBox["FileNameJoin",
                    Background->RGBColor[1, 0.9, 1]], 
                    StyleBox["[",
                    Background->RGBColor[1, 0.9, 1]], 
                    RowBox[{
                    StyleBox["{",
                    Background->RGBColor[1, 0.9, 1]], 
                    RowBox[{
                    RowBox[{"FileNameDrop", "[", 
                    StyleBox[
                    RowBox[{"out", ",", 
                    RowBox[{"-", "1"}]}],
                    Background->RGBColor[1, 0.9, 1]], 
                    StyleBox["]",
                    Background->RGBColor[1, 0.9, 1]]}], 
                    StyleBox[",",
                    Background->RGBColor[1, 0.9, 1]], 
                    RowBox[{"FileBaseName", "[", "file", "]"}]}], "}"}], 
                    "]"}], "<>", 
                    StyleBox["\"\<_\>\"",
                    Background->RGBColor[1, 0.9, 1]], 
                    StyleBox["<>",
                    Background->RGBColor[1, 0.9, 1]], 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"catalogo", ">", "0"}], ",", 
                    RowBox[{
                    "nts", "\[LeftDoubleBracket]", "catalogo", 
                    "\[RightDoubleBracket]"}], ",", "\"\<Orig\>\""}], "]"}], 
                    "<>", "\"\<.txt\>\""}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\"\<filename: \>\"", "<>", 
                    RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
                    "\"\< (\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "[", "data", "]"}], "]"}], "<>", 
                    "\"\</\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Length", "[", "orig", "]"}], "]"}], "<>", 
                    "\"\< eventi utilizzati)\>\""}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<catalogo: \>\"", "<>", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"catalogo", ">", "0"}], ",", 
                    RowBox[{
                    "nts", "\[LeftDoubleBracket]", "catalogo", 
                    "\[RightDoubleBracket]"}], ",", "\"\<Orig\>\""}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<timespan: \>\"", "<>", 
                    RowBox[{"ToString", "[", "cattspan", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<binsize: \>\"", "<>", 
                    RowBox[{"ToString", "@", "binsize"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"StringJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<magthresh: \>\"", ",", 
                    RowBox[{"ToString", "@", "magthresh"}], ",", 
                    "\"\< + \>\"", ",", 
                    RowBox[{"ToString", "@", "\[CapitalDelta]magL"}], ",", 
                    RowBox[{"\"\< - \>\"", "<>", 
                    RowBox[{"ToString", "@", "\[CapitalDelta]magH"}]}]}], 
                    "}"}], "]"}], ",", "\[IndentingNewLine]", 
                    "\"\<\\nvettore n. multiplette\>\"", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<removed: \>\"", "<>", "removed"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<GKradius: \>\"", "<>", "gkrad"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"ToString", "/@", 
                    RowBox[{"BinCounts", "[", 
                    RowBox[{
                    RowBox[{"clustimes", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}],
                     ",", "binsize"}], "]"}], ",", "binsize"}], "}"}]}], 
                    "]"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\"\<\\n\>\""}], "]"}], "\n", "}"}], "]"}], ",", 
                "\"\<String\>\""}], "]"}], ",", 
              RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"Button", "[", 
             StyleBox[
              RowBox[{"\"\<Reset\>\"", ",", 
               RowBox[{
                RowBox[{"rj", "=", "0"}], ";", 
                RowBox[{"catalogo", "=", "0"}], ";", 
                RowBox[{"ReleaseHold", "[", "clustaction", "]"}]}], ",", 
               RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}],
              Background->RGBColor[1, 0.9, 1]], 
             StyleBox["]",
              Background->RGBColor[1, 0.9, 1]]}]}], 
           StyleBox["}",
            Background->RGBColor[1, 0.9, 1]]}], 
          StyleBox["]",
           Background->RGBColor[1, 0.9, 1]]}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        StyleBox["\[IndentingNewLine]",
         Background->RGBColor[1, 0.9, 1]], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Show catalog global info\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"CreatePalette", "[", 
       RowBox[{
        RowBox[{"infodata", "[", "data", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"WindowTitle", "\[Rule]", "\"\<catalog global info\>\""}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        "0.02", ",", 
        RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
        RowBox[{"Enabled", "->", "tview"}]}], "}"}], ","}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"timespan", ",", "0.6"}], "}"}], ",", 
      RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"binsize", ",", 
        RowBox[{"Clip", "[", 
         RowBox[{
          RowBox[{"timespanorder", "/", "10"}], ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "1000"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "10", ",", "20", ",", "50", ",", "100", ",", "200", ",", "500", ",", 
        "1000"}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "Setter"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Delimiter", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"magthresh", ",", "5.5", ",", "\"\<Magnitude threshold\>\""}], 
       "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]magL", ",", ".5", ",", 
        "\"\<\[CapitalDelta]mag to LOWER events\>\""}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]magH", ",", ".5", ",", 
        "\"\<\[CapitalDelta]mag to HIGHER events\>\""}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "InputField"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"localmag", ",", "False"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"removed", ",", "\"\<GK\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<GK\>\"", ",", "\"\<GK-Mag\>\"", ",", "\"\<None\>\""}], 
       "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gkrad", ",", "\"\<sum\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<1st\>\"", ",", "\"\<max\>\"", ",", "\"\<sum\>\""}], 
       "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Clusterize!\>\"", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "amag", ",", "amagL", ",", "amagH", ",", "arem", ",", "arad"}], 
         "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "magthresh", ",", "\[CapitalDelta]magL", ",", "\[CapitalDelta]magH", 
          ",", "removed", ",", "gkrad"}], "}"}]}], ";", 
       RowBox[{"ReleaseHold", "[", "clustaction", "]"}]}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"poolflag", ",", "\"\< NEW \>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\< OLD \>\"", ",", "\"\< NEW \>\""}], "}"}], ",", 
        RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ","}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Show counts\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"CreateWindow", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DocumentNotebook", "[", "\[IndentingNewLine]", 
         RowBox[{"TextCell", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Column", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Labeled", "[", 
               RowBox[{
                RowBox[{"FileBaseName", "[", "file", "]"}], ",", 
                "\"\<filename\>\"", ",", "Left"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"catalogo", ">", "0"}], ",", 
                  RowBox[{
                  "nts", "\[LeftDoubleBracket]", "catalogo", 
                   "\[RightDoubleBracket]"}], ",", "\"\<Orig\>\""}], "]"}], 
                ",", "\"\<filename\>\"", ",", "Left"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{"cattspan", ",", "\"\<timespan\>\"", ",", "Left"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{"binsize", ",", "\"\<binsize\>\"", ",", "Left"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{"magthresh", ",", "\"\<magthresh\>\"", ",", "Left"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{
               "\[CapitalDelta]magL", ",", "\"\<\[CapitalDelta]+\>\"", ",", 
                "Left"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Labeled", "[", 
               RowBox[{
               "\[CapitalDelta]magH", ",", "\"\<\[CapitalDelta]-\>\"", ",", 
                "Left"}], "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"TableForm", "[", 
               RowBox[{"BinCounts", "[", 
                RowBox[{
                 RowBox[{"clustimes", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Append", "[", 
                  RowBox[{"cattspan", ",", "binsize"}], "]"}]}], "]"}], 
               "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\"\<Text\>\""}], "\[IndentingNewLine]", 
          "]"}], "]"}], ",", 
        RowBox[{
        "WindowTitle", "\[Rule]", "\"\<Multiplets occurrences\>\""}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "modificare", " ", "i", " ", "tasti", " ", "next", " ", "e", " ", "prev",
       " ", "clusters", " ", "per", " ", "navigare", " ", "nella", " ", 
      "lista", " ", "e", " ", "ottenere", " ", "il", " ", "tempo", " ", "da", 
      " ", "questa", " ", "e", " ", "non", " ", "direttamente"}], " ", "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{"Dynamic", "@", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{"\"\< < Prev Cluster  \>\"", ",", 
          RowBox[{
           RowBox[{"currmultip", "=", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"currmultip", "-", "1"}], ",", "1"}], "]"}]}], ";", 
           RowBox[{"t", "=", 
            RowBox[{"clustimes", "\[LeftDoubleBracket]", 
             RowBox[{"currmultip", ",", "1"}], 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<  Next Cluster > \>\"", ",", 
          RowBox[{
           RowBox[{"currmultip", "=", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Length", "[", "clustimes", "]"}], ",", 
              RowBox[{"currmultip", "+", "1"}]}], "]"}]}], ";", 
           RowBox[{"t", "=", 
            RowBox[{"clustimes", "\[LeftDoubleBracket]", 
             RowBox[{"currmultip", ",", "1"}], 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}], "]"}]}], ",", "\[IndentingNewLine]", "Delimiter", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"view", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<m_Hist\>\"", ",", "\"\<3D plot\>\"", ",", "\"\<Graph\>\""}], 
       "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "CheckboxBar"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"allnodes", ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ContinuousAction", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8235884285388927`*^9, 3.823588495443959*^9}, {
   3.823845510920182*^9, 3.823845530477469*^9}, {3.823845575996768*^9, 
   3.8238455913783703`*^9}, {3.823845758050544*^9, 3.8238457810807333`*^9}, 
   3.823847891553302*^9, 3.82384932111896*^9, {3.825577835877681*^9, 
   3.8255778425937023`*^9}, 3.825736217521665*^9, {3.836471263056445*^9, 
   3.836471271125702*^9}, {3.8364714866437263`*^9, 3.8364715132842484`*^9}, {
   3.836471653744157*^9, 3.836471658945825*^9}, {3.836496757542679*^9, 
   3.836496759758896*^9}, {3.8364992423616657`*^9, 3.836499243629031*^9}, 
   3.83967471777665*^9, {3.839676041845565*^9, 3.839676066591168*^9}, {
   3.8396937352697487`*^9, 3.839693783912816*^9}, {3.839694248136758*^9, 
   3.839694265854533*^9}, {3.839694306418331*^9, 3.839694381744196*^9}, {
   3.839769047588644*^9, 3.839769050656055*^9}, {3.8397706312902107`*^9, 
   3.839770655602054*^9}, {3.840187756806294*^9, 3.840187773628858*^9}, {
   3.840187819021089*^9, 3.840187852988379*^9}, 3.840188641781755*^9, {
   3.840188760012298*^9, 3.840188761439795*^9}, 3.840189173123178*^9, {
   3.8401892708882627`*^9, 3.840189302940123*^9}, {3.840189388324565*^9, 
   3.84018938845142*^9}, {3.8401912688644047`*^9, 3.840191336380724*^9}, {
   3.84019146596171*^9, 3.840191508411092*^9}, {3.840191630777918*^9, 
   3.84019166384124*^9}, {3.8401924248860407`*^9, 3.840192563741365*^9}, {
   3.840192596197998*^9, 3.840192742769002*^9}, {3.84019278133071*^9, 
   3.8401928596373243`*^9}, {3.840192908708138*^9, 3.840192950786963*^9}, {
   3.840193020204067*^9, 3.8401931111868477`*^9}, {3.840193179547*^9, 
   3.840193181998708*^9}, {3.840193493630082*^9, 3.8401934954038267`*^9}, {
   3.840193529611856*^9, 3.840193536106921*^9}, {3.840193631222123*^9, 
   3.840193690405325*^9}, {3.840533948188821*^9, 3.840533976954206*^9}, {
   3.8405354284669037`*^9, 3.8405354529710073`*^9}, 3.840535749675865*^9, {
   3.840704244270751*^9, 3.840704275833312*^9}, {3.8407043184500647`*^9, 
   3.8407043245051327`*^9}, {3.8407043623557367`*^9, 3.840704377056919*^9}, {
   3.84070441444351*^9, 3.840704457539418*^9}, {3.840704534945601*^9, 
   3.840704555711648*^9}, {3.840704717725086*^9, 3.84070473672751*^9}, 
   3.840704794562161*^9, {3.840704933943141*^9, 3.8407049392680387`*^9}, {
   3.840705005603544*^9, 3.840705033065586*^9}, {3.840706057751877*^9, 
   3.840706060069825*^9}, {3.840706091826213*^9, 3.840706150770455*^9}, {
   3.840706383257655*^9, 3.84070643908143*^9}, {3.840706893366395*^9, 
   3.840706915995269*^9}, {3.8407070304537067`*^9, 3.8407071531402082`*^9}, {
   3.840707502974058*^9, 3.840707541633683*^9}, 3.875614903039392*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"cb56477e-96a3-4c55-9345-4a4c951c867f"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/robertocarluccio/Library/Mobile \
Documents/com~apple~CloudDocs/ingv/clustest.m\>\""}]], "Input",
 CellChangeTimes->{{3.875614274151868*^9, 3.8756142747791767`*^9}, {
   3.875771811016944*^9, 3.8757718111749487`*^9}, 3.875771945408471*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"a345ed1c-8ba4-4730-bc21-63b15cd7ed6c"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8757719489246283`*^9, 
  3.875771948926867*^9}},ExpressionUUID->"5118b27b-d63c-4171-881e-\
bcf0c96893f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"clusterize", "[", 
   RowBox[{"orig", ",", 
    RowBox[{"{", 
     RowBox[{"5.5", ",", ".6", ",", ".4"}], "}"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.875771956279203*^9, 3.875771960127871*^9}, {
  3.875772012301145*^9, 3.875772057396616*^9}, {3.875772131110999*^9, 
  3.8757721494858923`*^9}, {3.875793779242729*^9, 3.875793782627178*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"9ace504c-358d-475a-830c-e56a4a915c3e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"95807", ",", "2123", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1742"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "307"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "2"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.875772028505431*^9, 3.8757720761287317`*^9, {3.8757721512288094`*^9, 
   3.875772172126937*^9}, 3.875793552894657*^9, 3.8757938074992647`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"22f3347a-107b-4661-b85a-a305fb0218ae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"?", "clusterize"}]], "Input",
 CellChangeTimes->{{3.8757720382268267`*^9, 3.87577204113099*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"8c6aa501-aea8-4b55-8967-d0f292dfc228"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1551, 838},
WindowMargins->{{0, Automatic}, {Automatic, 93}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1c352180-fa38-4397-98cd-b6a1cae58716"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 233, 4, 67, "Section",ExpressionUUID->"2d257552-89d8-4824-8810-853e93dab373"],
Cell[816, 28, 514, 13, 35, "Text",ExpressionUUID->"4318576f-3a1d-429e-866c-94e506562991"],
Cell[1333, 43, 3124, 69, 110, "Input",ExpressionUUID->"dd1bbe55-77a3-4a41-877c-3a24b383fa6c",
 InitializationCell->True],
Cell[4460, 114, 1124, 27, 58, "Text",ExpressionUUID->"f0f5c79a-4225-4f7c-b31b-e7ea4bc1b21a"],
Cell[5587, 143, 4296, 121, 213, "Input",ExpressionUUID->"0c866893-59fb-4cb2-9bc2-7915aa8b5ecf",
 InitializationCell->True],
Cell[9886, 266, 1098, 34, 104, "Text",ExpressionUUID->"53333f2b-a420-4f31-b57a-3138c7e85cb2"],
Cell[10987, 302, 8898, 219, 372, "Input",ExpressionUUID->"97bec193-9865-46ce-95ac-7ab3a3e8c628",
 InitializationCell->True],
Cell[19888, 523, 3027, 72, 110, "Input",ExpressionUUID->"3dc942fb-fd55-4cbc-9f89-9bc8514c3e69",
 InitializationCell->True],
Cell[22918, 597, 601, 10, 58, "Text",ExpressionUUID->"0efbab32-beb2-40de-9109-7ef99f959725"],
Cell[23522, 609, 1985, 45, 194, "Input",ExpressionUUID->"2d1dbb5d-0816-40f9-840f-9c99ab629ba3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25532, 658, 446, 7, 54, "Subsection",ExpressionUUID->"0aea74f1-3b4d-4806-9847-c43ccfcc2d13"],
Cell[25981, 667, 275, 4, 35, "Text",ExpressionUUID->"2ffbe1a3-c67c-4e10-aacf-abcd7ca8914f"],
Cell[26259, 673, 14265, 326, 1023, "Input",ExpressionUUID->"f6aa0e7b-7a1f-440d-a2a0-648ee2ebed31",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40573, 1005, 206, 4, 67, "Section",ExpressionUUID->"b85a94c2-4ed1-4ae5-b912-1d425e894d28"],
Cell[CellGroupData[{
Cell[40804, 1013, 215, 4, 54, "Subsection",ExpressionUUID->"394754c4-d1b9-4b86-b464-8552fc129f62"],
Cell[41022, 1019, 653, 12, 30, "Input",ExpressionUUID->"8352a4da-6c00-4d12-b145-28b93997cc22"],
Cell[41678, 1033, 627, 12, 30, "Input",ExpressionUUID->"3cd6966a-18e9-4238-8d28-3277bc6ebe54"],
Cell[CellGroupData[{
Cell[42330, 1049, 2015, 52, 262, "Input",ExpressionUUID->"802ffbfd-7999-4f14-903d-cb185cee7a46"],
Cell[44348, 1103, 403, 6, 34, "Output",ExpressionUUID->"121c9a80-9d76-400c-aafa-200df61759bb"],
Cell[44754, 1111, 928, 24, 45, "Output",ExpressionUUID->"da11e46c-991c-4c61-be19-49091f4a9d1f"],
Cell[45685, 1137, 373, 6, 34, "Output",ExpressionUUID->"80dd75f4-0701-4de2-b3a7-b6e12c236e70"],
Cell[46061, 1145, 924, 24, 45, "Output",ExpressionUUID->"72765a55-70dd-4d4c-b698-4bd6419f3350"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47046, 1176, 159, 3, 67, "Section",ExpressionUUID->"2fd14590-5081-42e9-96a3-df3f81ede526"],
Cell[47208, 1181, 534, 11, 104, "Text",ExpressionUUID->"8dbc9d81-b514-4f0f-af15-4497eafb8b98"],
Cell[CellGroupData[{
Cell[47767, 1196, 213, 4, 54, "Subsection",ExpressionUUID->"dd2921a5-d352-40bf-951e-6501c73d7cf6"],
Cell[47983, 1202, 1613, 46, 157, "Text",ExpressionUUID->"20a687b4-8cb9-41d0-860d-df0bb446769d"],
Cell[CellGroupData[{
Cell[49621, 1252, 5246, 116, 409, "Input",ExpressionUUID->"7df17c96-2d92-4c4a-a388-14eda996d67a"],
Cell[54870, 1370, 906, 23, 45, "Output",ExpressionUUID->"55a2ce53-6cdf-4f79-a4d9-0d777e23a365"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55825, 1399, 1331, 19, 54, "Subsection",ExpressionUUID->"3f2329e2-c500-4bdf-aa0e-388697c101b6"],
Cell[CellGroupData[{
Cell[57181, 1422, 161, 3, 45, "Subsubsection",ExpressionUUID->"abac43e3-54b9-4bbb-b921-182846ebf0ce"],
Cell[57345, 1427, 10739, 244, 663, "Input",ExpressionUUID->"2dac22e2-5c33-49cd-81f2-635db2cc51d6"]
}, Closed]],
Cell[CellGroupData[{
Cell[68121, 1676, 229, 4, 37, "Subsubsection",ExpressionUUID->"16d073b8-b293-4c81-9249-a4b713037a15"],
Cell[68353, 1682, 5796, 122, 283, "Input",ExpressionUUID->"b740fd49-2e43-483f-b1dd-95dc9c95132a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74198, 1810, 221, 4, 54, "Subsection",ExpressionUUID->"beb23643-7bec-4ebe-91e6-692fb9311777"],
Cell[74422, 1816, 201, 3, 35, "Text",ExpressionUUID->"17cd7e79-31f1-4c0e-a694-1502552c3799"],
Cell[74626, 1821, 113961, 2566, 6513, "Input",ExpressionUUID->"cb56477e-96a3-4c55-9345-4a4c951c867f"],
Cell[188590, 4389, 362, 6, 30, "Input",ExpressionUUID->"a345ed1c-8ba4-4730-bc21-63b15cd7ed6c"],
Cell[188955, 4397, 154, 3, 30, "Input",ExpressionUUID->"5118b27b-d63c-4171-881e-bcf0c96893f7"],
Cell[CellGroupData[{
Cell[189134, 4404, 522, 11, 30, "Input",ExpressionUUID->"9ace504c-358d-475a-830c-e56a4a915c3e"],
Cell[189659, 4417, 750, 20, 34, "Output",ExpressionUUID->"22f3347a-107b-4661-b85a-a305fb0218ae"]
}, Open  ]],
Cell[190424, 4440, 199, 3, 30, "Input",ExpressionUUID->"8c6aa501-aea8-4b55-8967-d0f292dfc228"]
}, Open  ]]
}, Open  ]]
}
]
*)

